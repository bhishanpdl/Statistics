<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Resampling methods &mdash; Computational Statistics in Python 0.1 documentation</title>
    
    <script type="text/javascript" nonce="9c673de102144be99c3f645910c" src="//local.adguard.org?ts=1618062739594&amp;type=content-script&amp;dmn=people.duke.edu&amp;css=1&amp;js=1&amp;gcss=1&amp;rel=1&amp;rji=1&amp;stealth=1&amp;uag=&amp;trref=aHR0cHM6Ly9wZW9wbGUuZHVrZS5lZHUv"></script>
<script type="text/javascript" nonce="9c673de102144be99c3f645910c" src="//local.adguard.org?ts=1618062739594&amp;name=AdGuard%20Extra%20Beta&amp;type=user-script"></script><link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.2.0/readable/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Computational Statistics in Python 0.1 documentation" href="index.html" />
    <link rel="next" title="Markov Chain Monte Carlo (MCMC)" href="MCMC.html" />
    <link rel="prev" title="Monte Carlo Methods" href="MonteCarlo.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Computational Statistics in Python</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="IntroductionToPythonSolutions.html">Introduction to Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#variables">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#operators">Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#iterators">Iterators</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#conditional-statements">Conditional Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#strings-and-string-handling">Strings and String Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#lists-tuples-dictionaries">Lists, Tuples, Dictionaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#classes">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#modules">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#the-standard-library">The standard library</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#keeping-the-anaconda-distribution-up-to-date">Keeping the Anaconda distribution up-to-date</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="IPythonNotebookIntroduction.html">Getting started with Python and the IPython notebook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="IPythonNotebookIntroduction.html#cells">Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="IPythonNotebookIntroduction.html#code-cells">Code Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="IPythonNotebookIntroduction.html#magic-commands">Magic Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="IPythonNotebookIntroduction.html#python-as-glue">Python as Glue</a></li>
<li class="toctree-l2"><a class="reference internal" href="IPythonNotebookIntroduction.html#python-r-matlab-octave">Python &lt;-&gt; R &lt;-&gt; Matlab &lt;-&gt; Octave</a></li>
<li class="toctree-l2"><a class="reference internal" href="IPythonNotebookIntroduction.html#more-glue-julia-and-perl">More Glue: Julia and Perl</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html">Functions are first class objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#function-argumnents">Function argumnents</a><ul>
<li class="toctree-l2"><a class="reference internal" href="FunctionsSolutions.html#call-by-object-reference">Call by &#8220;object reference&#8221;</a></li>
<li class="toctree-l2"><a class="reference internal" href="FunctionsSolutions.html#binding-of-default-arguments-occurs-at-function-definition">Binding of default arguments occurs at function <em>definition</em></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#higher-order-functions">Higher-order functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#anonymous-functions">Anonymous functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#pure-functions">Pure functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#recursion">Recursion</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#iterators">Iterators</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#generators">Generators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="FunctionsSolutions.html#generators-and-comprehensions">Generators and comprehensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="FunctionsSolutions.html#utilites-enumerate-zip-and-the-ternary-if-else-operator">Utilites - enumerate, zip and the ternary if-else operator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#decorators">Decorators</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#the-operator-module">The <code class="docutils literal"><span class="pre">operator</span></code> module</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#the-functools-module">The <code class="docutils literal"><span class="pre">functools</span></code> module</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#the-itertools-module">The <code class="docutils literal"><span class="pre">itertools</span></code> module</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#the-toolz-fn-and-funcy-modules">The <code class="docutils literal"><span class="pre">toolz</span></code>, <code class="docutils literal"><span class="pre">fn</span></code> and <code class="docutils literal"><span class="pre">funcy</span></code> modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#exercises">Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="DataProcessingSolutions.html">Data science is OSEMN</a><ul>
<li class="toctree-l2"><a class="reference internal" href="DataProcessingSolutions.html#obtaining-data">Obtaining data</a></li>
<li class="toctree-l2"><a class="reference internal" href="DataProcessingSolutions.html#scrubbing-data">Scrubbing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="DataProcessingSolutions.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="TextProcessingSolutions.html">Working with text</a><ul>
<li class="toctree-l2"><a class="reference internal" href="TextProcessingSolutions.html#string-methods">String methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="TextProcessingSolutions.html#splitting-and-joining-strings">Splitting and joining strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="TextProcessingSolutions.html#the-string-module">The string module</a></li>
<li class="toctree-l2"><a class="reference internal" href="TextProcessingSolutions.html#regular-expressions">Regular expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="TextProcessingSolutions.html#the-nltk-toolkit">The NLTK toolkit</a></li>
<li class="toctree-l2"><a class="reference internal" href="TextProcessingSolutions.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="TextProcessingExtras.html">Preprocessing text data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="TextProcessingExtras.html#example-counting-words-in-a-document">Example: Counting words in a document</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="WorkingWithStructuredData.html">Working with structured data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="WorkingWithStructuredData.html#using-sqlite3">Using SQLite3</a></li>
<li class="toctree-l2"><a class="reference internal" href="WorkingWithStructuredData.html#basic-concepts-of-database-normalization">Basic concepts of database normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="WorkingWithStructuredData.html#using-hdf5">Using HDF5</a></li>
<li class="toctree-l2"><a class="reference internal" href="WorkingWithStructuredData.html#interfacing-withpandas">Interfacing withPandas</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="UsingNumpySolutions.html">Using numpy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#ndarray">NDArray</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#broadcasting-row-column-and-matrix-operations">Broadcasting, row, column and matrix operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#universal-functions-ufuncs">Universal functions (Ufuncs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#generalized-ufucns">Generalized ufucns</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#random-numbers">Random numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#linear-algebra">Linear algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="UsingPandas.html">Using Pandas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="UsingPandas.html#series">Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingPandas.html#dataframe">DataFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingPandas.html#panels">Panels</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingPandas.html#split-apply-combine">Split-Apply-Combine</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingPandas.html#using-statsmodels">Using statsmodels</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="UsingPandas.html#using-r-from-ipython">Using R from IPython</a><ul>
<li class="toctree-l2"><a class="reference internal" href="UsingPandas.html#using-rmagic">Using Rmagic</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingPandas.html#using-r-from-pandas">Using R from pandas</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ComputationalStatisticsMotivation.html">Computational problems in statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ComputationalStatisticsMotivation.html#textbook-example-is-coin-fair">Textbook example - is coin fair?</a></li>
<li class="toctree-l2"><a class="reference internal" href="ComputationalStatisticsMotivation.html#bayesian-approach">Bayesian approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="ComputationalStatisticsMotivation.html#comment">Comment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ComputerArithmetic.html">Computer numbers and mathematics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ComputerArithmetic.html#some-examples-of-numbers-behaving-badly">Some examples of numbers behaving badly</a></li>
<li class="toctree-l2"><a class="reference internal" href="ComputerArithmetic.html#finite-representation-of-numbers">Finite representation of numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="ComputerArithmetic.html#using-arbitrary-precision-libraries">Using arbitrary precision libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="ComputerArithmetic.html#from-numbers-to-functions-stability-and-conditioning">From numbers to Functions: Stability and conditioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="ComputerArithmetic.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="AlgorithmicComplexity.html">Algorithmic complexity</a><ul>
<li class="toctree-l2"><a class="reference internal" href="AlgorithmicComplexity.html#profling-and-benchmarking">Profling and benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="AlgorithmicComplexity.html#measuring-algorithmic-complexity">Measuring algorithmic complexity</a></li>
<li class="toctree-l2"><a class="reference internal" href="AlgorithmicComplexity.html#space-complexity">Space complexity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="LinearAlgebraReview.html">Linear Algebra and Linear Systems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#simultaneous-equations">Simultaneous Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#linear-independence">Linear Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#norms-and-distance-of-vectors">Norms and Distance of Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#trace-and-determinant-of-matrices">Trace and Determinant of Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#column-space-row-space-rank-and-kernel">Column space, Row space, Rank and Kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#matrices-as-linear-transformations">Matrices as Linear Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#matrix-norms">Matrix Norms</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#special-matrices">Special Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html">Linear Algebra and Matrix Decompositions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html#large-linear-systems">Large Linear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html#example-netflix-competition-circa-2006-2009">Example: Netflix Competition (circa 2006-2009)</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html#matrix-decompositions">Matrix Decompositions</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html#matrix-decompositions-for-pca-and-least-squares">Matrix Decompositions for PCA and Least Squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html#singular-value-decomposition">Singular Value Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html#stabilty-and-condition-number">Stabilty and Condition Number</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PCASolutions.html">Change of Basis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="PCASolutions.html#variance-and-covariance">Variance and covariance</a></li>
<li class="toctree-l2"><a class="reference internal" href="PCASolutions.html#eigendecomposition-of-the-covariance-matrix">Eigendecomposition of the covariance matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="PCASolutions.html#pca">PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="PCASolutions.html#change-of-basis-via-pca">Change of basis via PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="PCASolutions.html#graphical-illustration-of-change-of-basis">Graphical illustration of change of basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="PCASolutions.html#dimension-reduction-via-pca">Dimension reduction via PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="PCASolutions.html#using-singular-value-decomposition-svd-for-pca">Using Singular Value Decomposition (SVD) for PCA</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationInOneDimension.html">Optimization and Non-linear Methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="OptimizationInOneDimension.html#example-maximum-likelihood-estimation-mle">Example: Maximum Likelihood Estimation (MLE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="OptimizationInOneDimension.html#bisection-method">Bisection Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="OptimizationInOneDimension.html#secant-method">Secant Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="OptimizationInOneDimension.html#newton-rhapson-method">Newton-Rhapson Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="OptimizationInOneDimension.html#gauss-newton">Gauss-Newton</a></li>
<li class="toctree-l2"><a class="reference internal" href="OptimizationInOneDimension.html#inverse-quadratic-interpolation">Inverse Quadratic Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="OptimizationInOneDimension.html#brent-s-method">Brent&#8217;s Method</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="BlackBoxOptimization.html">Practical Optimizatio Routines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#finding-roots">Finding roots</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#optimization-primer">Optimization Primer</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#using-scipy-optimize">Using <code class="docutils literal"><span class="pre">scipy.optimize</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#gradient-deescent">Gradient deescent</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#newton-s-method-and-variants">Newton&#8217;s method and variants</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#constrained-optimization">Constrained optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#curve-fitting">Curve fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#finding-paraemeters-for-ode-models">Finding paraemeters for ODE models</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#optimization-of-graph-node-placement">Optimization of graph node placement</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#optimization-of-standard-statistical-models">Optimization of standard statistical models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="CalibratingODEs.html">Fitting ODEs with the Levenbergâ€“Marquardt algorithm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="CalibratingODEs.html#d-example">1D example</a></li>
<li class="toctree-l2"><a class="reference internal" href="CalibratingODEs.html#id1">2D example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MultivariateOptimizationAlgortihms.html">Algorithms for Optimization and Root Finding for Multivariate Problems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MultivariateOptimizationAlgortihms.html#optimizers">Optimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultivariateOptimizationAlgortihms.html#solvers">Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultivariateOptimizationAlgortihms.html#glm-estimation-and-irls">GLM Estimation and IRLS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="EMAlgorithm.html">Expectation Maximizatio (EM) Algorithm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#jensen-s-inequality">Jensen&#8217;s inequality</a></li>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#maximum-likelihood-with-complete-information">Maximum likelihood with complete information</a></li>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#incomplete-information">Incomplete information</a></li>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#gaussian-mixture-models">Gaussian mixture models</a></li>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#using-em">Using EM</a></li>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#vectorized-version">Vectorized version</a></li>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#vectorization-with-einstein-summation-notation">Vectorization with Einstein summation notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#comparison-of-em-routines">Comparison of EM routines</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MonteCarlo.html">Monte Carlo Methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MonteCarlo.html#pseudorandom-number-generators-prng">Pseudorandom number generators (PRNG)</a></li>
<li class="toctree-l2"><a class="reference internal" href="MonteCarlo.html#monte-carlo-swindles-variance-reduction-techniques">Monte Carlo swindles (Variance reduction techniques)</a></li>
<li class="toctree-l2"><a class="reference internal" href="MonteCarlo.html#quasi-random-numbers">Quasi-random numbers</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Resampling methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#resampling">Resampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simulations">Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-the-random-seed">Setting the random seed</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sampling-with-and-without-replacement">Sampling with and without replacement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#calculation-of-cook-s-distance">Calculation of Cook&#8217;s distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#permutation-resampling">Permutation resampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#design-of-simulation-experiments">Design of simulation experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-simulations-to-estimate-power">Example: Simulations to estimate power</a></li>
<li class="toctree-l2"><a class="reference internal" href="#check-with-r">Check with R</a></li>
<li class="toctree-l2"><a class="reference internal" href="#estimating-the-cdf">Estimating the CDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="#estimating-the-pdf">Estimating the PDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="#kernel-density-estimation">Kernel density estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multivariate-kerndel-density-estimation">Multivariate kerndel density estimation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MCMC.html">Markov Chain Monte Carlo (MCMC)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MCMC.html#bayesian-data-analysis">Bayesian Data Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="MCMC.html#metropolis-hastings-sampler">Metropolis-Hastings sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="MCMC.html#gibbs-sampler">Gibbs sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="MCMC.html#slice-sampler">Slice sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="MCMC.html#hierarchical-models">Hierarchical models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PyMC2.html">Using PyMC2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="PyMC2.html#coin-toss">Coin toss</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC2.html#estimating-mean-and-standard-deviation-of-normal-distribution">Estimating mean and standard deviation of normal distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC2.html#estimating-parameters-of-a-linear-regreession-model">Estimating parameters of a linear regreession model</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC2.html#estimating-parameters-of-a-logistic-model">Estimating parameters of a logistic model</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC2.html#using-a-hierarchcical-model">Using a hierarchcical model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PyMC3.html">Using PyMC3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="PyMC3.html#coin-toss">Coin toss</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC3.html#estimating-mean-and-standard-deviation-of-normal-distribution">Estimating mean and standard deviation of normal distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC3.html#estimating-parameters-of-a-linear-regreession-model">Estimating parameters of a linear regreession model</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC3.html#estimating-parameters-of-a-logistic-model">Estimating parameters of a logistic model</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC3.html#using-a-hierarchcical-model">Using a hierarchcical model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PyStan.html">Using PyStan</a><ul>
<li class="toctree-l2"><a class="reference internal" href="PyStan.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyStan.html#simple-logistic-model">Simple Logistic model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Animation.html">Animations of Metropolis, Gibbs and Slice Sampler dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="CrashCourseInC.html">C Crash Course</a><ul>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#hello-world">Hello world</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#a-tutorial-example-coding-a-fibonacci-function-in-c">A tutorial example - coding a Fibonacci function in C</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#types-in-c">Types in C</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#operators">Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#control-of-program-flow">Control of program flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#arrays-and-pointers">Arrays and pointers</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#function-pointers">Function pointers</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#using-make-to-compile-c-programs">Using make to compile C programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MakingCodeFast.html">Code Optimization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MakingCodeFast.html#profiling">Profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="MakingCodeFast.html#using-better-algorihtms-and-data-structures">Using better algorihtms and data structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="MakingCodeFast.html#i-o-bound-problems">I/O Bound problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="MakingCodeFast.html#problem-set-for-optimization">Problem set for optimization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FromCToPython.html">Using C code in Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="FromCToPython.html#example-the-fibonacci-sequence">Example: The Fibonacci Sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCToPython.html#using-clang-and-bitey">Using clang and bitey</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCToPython.html#using-gcc-and-ctypes">Using gcc and ctypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCToPython.html#using-cython">Using Cython</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCToPython.html#benchmark">Benchmark</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FromCompiledToPython.html">Using functions from various compiled languages in Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="FromCompiledToPython.html#c">C</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCompiledToPython.html#id1">C++</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCompiledToPython.html#fortran">Fortran</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCompiledToPython.html#benchmarking">Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCompiledToPython.html#wrapping-a-function-from-a-c-library-for-use-in-python">Wrapping a function from a C library for use in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCompiledToPython.html#wrapping-functions-from-c-library-for-use-in-pyton">Wrapping functions from C++ library for use in Pyton</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FromJuliaToPython.html">Julia and Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="FromJuliaToPython.html#defining-a-function-in-julia">Defining a function in Julia</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromJuliaToPython.html#using-it-in-python">Using it in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromJuliaToPython.html#using-python-libraries-in-julia">Using Python libraries in Julia</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FromPythonToC.html">Converting Python Code to C for speed</a><ul>
<li class="toctree-l2"><a class="reference internal" href="FromPythonToC.html#example-fibonacci">Example: Fibonacci</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromPythonToC.html#example-matrix-multiplication">Example: Matrix multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromPythonToC.html#example-pairwise-distance-matrix">Example: Pairwise distance matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromPythonToC.html#profiling-code">Profiling code</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromPythonToC.html#numba">Numba</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromPythonToC.html#cython">Cython</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromPythonToC.html#comparison-with-optimized-c-from-scipy">Comparison with optimized C from scipy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Optimization_Bakeoff.html">Optimization bake-off</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#python-version">Python version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#numpy-version">Numpy version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#numexpr-version">Numexpr version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#numba-version">Numba version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#numbapro-version">NumbaPro version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#parakeet-version">Parakeet version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#cython-version">Cython version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#c-version">C version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#id1">C++ version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#fortran-version">Fortran version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#bake-off">Bake-off</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#recommendations-for-optimizing-python-code">Recommendations for optimizing Python code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="WritingParallelCode.html">Writing Parallel Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="WritingParallelCode.html#concepts">Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="WritingParallelCode.html#embarassingly-parallel-programs">Embarassingly parallel programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="WritingParallelCode.html#using-multiprocessing">Using Multiprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="WritingParallelCode.html#using-ipython-parallel-for-interactive-parallel-computing">Using IPython parallel for interactive parallel computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="WritingParallelCode.html#other-parallel-programming-approaches-not-covered">Other parallel programming approaches not covered</a></li>
<li class="toctree-l2"><a class="reference internal" href="WritingParallelCode.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="CUDAPython.html">Massively parallel programming with GPUs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#programming-gpus">Programming GPUs</a></li>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#gpu-architecture">GPU Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#cuda-python">CUDA Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#getting-started-with-cuda">Getting Started with CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#vector-addition-the-hello-world-of-cuda">Vector addition - the &#8216;Hello, world&#8217; of CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#performing-a-reduction-on-cuda">Performing a reduction on CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#recreational">Recreational</a></li>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#more-examples">More examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="GPUsAndCUDAC.html">Writing CUDA in C</a><ul>
<li class="toctree-l2"><a class="reference internal" href="GPUsAndCUDAC.html#review-of-gpu-architechture-a-simplification">Review of GPU Architechture - A Simplification</a></li>
<li class="toctree-l2"><a class="reference internal" href="GPUsAndCUDAC.html#cuda-c-program-an-outline">Cuda C program - an Outline</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="DistributedComputing.html">Distributed computing for Big Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="DistributedComputing.html#why-and-when-does-distributed-computing-matter">Why and when does distributed computing matter?</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedComputing.html#ingredients-for-effiicient-distributed-computing">Ingredients for effiicient distributed computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedComputing.html#what-is-hadoop">What is Hadoop?</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedComputing.html#review-of-functional-programming">Review of functional programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedComputing.html#the-hadoop-mapreduce-workflow">The Hadoop MapReduce workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedComputing.html#using-hadoop-mapreduce">Using Hadoop MapReduce</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedComputing.html#spark">Spark</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MapReduce.html">Hadoop MapReduce on AWS EMR with <code class="docutils literal"><span class="pre">mrjob</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="MapReduce.html#mapreduce-code">MapReduce code</a></li>
<li class="toctree-l2"><a class="reference internal" href="MapReduce.html#configuration-file">Configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="MapReduce.html#launching-job">Launching job</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Spark.html">Spark on a local mahcine using 4 nodes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Spark.html#using-spark-in-standalone-prograsm">Using Spark in standalone prograsm</a></li>
<li class="toctree-l2"><a class="reference internal" href="Spark.html#introduction-to-spark-concepts-with-a-data-manipulation-example">Introduction to Spark concepts with a data manipulation example</a></li>
<li class="toctree-l2"><a class="reference internal" href="Spark.html#using-the-mllib-for-regression">Using the MLlib for Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="Spark.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ModulesAndPackaging.html">Modules and Packaging</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ModulesAndPackaging.html#modules">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="ModulesAndPackaging.html#distributing-your-package">Distributing your package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Jupyter.html">Tour of the Jupyter (IPython3) notebook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Jupyter.html#installing-jupyter">Installing Jupyter</a></li>
<li class="toctree-l2"><a class="reference internal" href="Jupyter.html#installing-other-kernels">Installing other kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="Jupyter.html#installing-extensions">Installing extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Jupyter.html#installing-python3-while-keeping-python2">Installing Python3 while keeping Python2</a></li>
<li class="toctree-l2"><a class="reference internal" href="Jupyter.html#now-restart-your-notebook-server">Now, restart your notebook server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MultiKernel.html">Polyglot programming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MultiKernel.html#python-2">Python 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultiKernel.html#python-3">Python 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultiKernel.html#bash">Bash</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultiKernel.html#r">R</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultiKernel.html#scala">Scala</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultiKernel.html#julia">Julia</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultiKernel.html#processing">Processing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ReveiwAndTrends.html">What you should know and learn more about</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ReveiwAndTrends.html#statistical-foundations">Statistical foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ReveiwAndTrends.html#computing-foundations">Computing foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ReveiwAndTrends.html#mathematical-foundations">Mathematical foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ReveiwAndTrends.html#statistical-algorithms">Statistical algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="ReveiwAndTrends.html#libraries-worth-knowing-about-after-numpy-scipy-and-matplotlib">Libraries worth knowing about after numpy, scipy and matplotlib</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Resampling methods</a><ul>
<li><a class="reference internal" href="#resampling">Resampling</a></li>
<li><a class="reference internal" href="#simulations">Simulations</a></li>
<li><a class="reference internal" href="#setting-the-random-seed">Setting the random seed</a><ul>
<li><a class="reference internal" href="#id1">Resampling</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sampling-with-and-without-replacement">Sampling with and without replacement</a><ul>
<li><a class="reference internal" href="#bootstrap">Bootstrap</a><ul>
<li><a class="reference internal" href="#reprise-of-bootstrap-example-for-monte-carlo-integration">Reprise of bootstrap example for Monte Carlo integration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#leave-some-out-resampling">Leave some-out resampling</a><ul>
<li><a class="reference internal" href="#jackknife-estimate-of-parameters">Jackknife estimate of parameters</a></li>
<li><a class="reference internal" href="#leave-one-out-cross-validation-loocv">Leave one out cross validation (LOOCV)</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#calculation-of-cook-s-distance">Calculation of Cook&#8217;s distance</a></li>
<li><a class="reference internal" href="#permutation-resampling">Permutation resampling</a><ul>
<li><a class="reference internal" href="#monte-carlo-simulations">Monte Carlo Simulations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#design-of-simulation-experiments">Design of simulation experiments</a></li>
<li><a class="reference internal" href="#example-simulations-to-estimate-power">Example: Simulations to estimate power</a></li>
<li><a class="reference internal" href="#check-with-r">Check with R</a><ul>
<li><a class="reference internal" href="#characterizing-monte-carlo-samples">Characterizing Monte Carlo samples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#estimating-the-cdf">Estimating the CDF</a></li>
<li><a class="reference internal" href="#estimating-the-pdf">Estimating the PDF</a></li>
<li><a class="reference internal" href="#kernel-density-estimation">Kernel density estimation</a></li>
<li><a class="reference internal" href="#multivariate-kerndel-density-estimation">Multivariate kerndel density estimation</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="MonteCarlo.html" title="Previous Chapter: Monte Carlo Methods"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Monte Carlo Meth...</span>
    </a>
  </li>
  <li>
    <a href="MCMC.html" title="Next Chapter: Markov Chain Monte Carlo (MCMC)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Markov Chain Mon... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul class="globaltoc"
><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="IntroductionToPythonSolutions.html">Introduction to Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#variables">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#operators">Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#iterators">Iterators</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#conditional-statements">Conditional Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#strings-and-string-handling">Strings and String Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#lists-tuples-dictionaries">Lists, Tuples, Dictionaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#classes">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#modules">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#the-standard-library">The standard library</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#keeping-the-anaconda-distribution-up-to-date">Keeping the Anaconda distribution up-to-date</a></li>
<li class="toctree-l2"><a class="reference internal" href="IntroductionToPythonSolutions.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="IPythonNotebookIntroduction.html">Getting started with Python and the IPython notebook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="IPythonNotebookIntroduction.html#cells">Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="IPythonNotebookIntroduction.html#code-cells">Code Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="IPythonNotebookIntroduction.html#magic-commands">Magic Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="IPythonNotebookIntroduction.html#python-as-glue">Python as Glue</a></li>
<li class="toctree-l2"><a class="reference internal" href="IPythonNotebookIntroduction.html#python-r-matlab-octave">Python &lt;-&gt; R &lt;-&gt; Matlab &lt;-&gt; Octave</a></li>
<li class="toctree-l2"><a class="reference internal" href="IPythonNotebookIntroduction.html#more-glue-julia-and-perl">More Glue: Julia and Perl</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html">Functions are first class objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#function-argumnents">Function argumnents</a><ul>
<li class="toctree-l2"><a class="reference internal" href="FunctionsSolutions.html#call-by-object-reference">Call by &#8220;object reference&#8221;</a></li>
<li class="toctree-l2"><a class="reference internal" href="FunctionsSolutions.html#binding-of-default-arguments-occurs-at-function-definition">Binding of default arguments occurs at function <em>definition</em></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#higher-order-functions">Higher-order functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#anonymous-functions">Anonymous functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#pure-functions">Pure functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#recursion">Recursion</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#iterators">Iterators</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#generators">Generators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="FunctionsSolutions.html#generators-and-comprehensions">Generators and comprehensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="FunctionsSolutions.html#utilites-enumerate-zip-and-the-ternary-if-else-operator">Utilites - enumerate, zip and the ternary if-else operator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#decorators">Decorators</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#the-operator-module">The <code class="docutils literal"><span class="pre">operator</span></code> module</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#the-functools-module">The <code class="docutils literal"><span class="pre">functools</span></code> module</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#the-itertools-module">The <code class="docutils literal"><span class="pre">itertools</span></code> module</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#the-toolz-fn-and-funcy-modules">The <code class="docutils literal"><span class="pre">toolz</span></code>, <code class="docutils literal"><span class="pre">fn</span></code> and <code class="docutils literal"><span class="pre">funcy</span></code> modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionsSolutions.html#exercises">Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="DataProcessingSolutions.html">Data science is OSEMN</a><ul>
<li class="toctree-l2"><a class="reference internal" href="DataProcessingSolutions.html#obtaining-data">Obtaining data</a></li>
<li class="toctree-l2"><a class="reference internal" href="DataProcessingSolutions.html#scrubbing-data">Scrubbing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="DataProcessingSolutions.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="TextProcessingSolutions.html">Working with text</a><ul>
<li class="toctree-l2"><a class="reference internal" href="TextProcessingSolutions.html#string-methods">String methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="TextProcessingSolutions.html#splitting-and-joining-strings">Splitting and joining strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="TextProcessingSolutions.html#the-string-module">The string module</a></li>
<li class="toctree-l2"><a class="reference internal" href="TextProcessingSolutions.html#regular-expressions">Regular expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="TextProcessingSolutions.html#the-nltk-toolkit">The NLTK toolkit</a></li>
<li class="toctree-l2"><a class="reference internal" href="TextProcessingSolutions.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="TextProcessingExtras.html">Preprocessing text data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="TextProcessingExtras.html#example-counting-words-in-a-document">Example: Counting words in a document</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="WorkingWithStructuredData.html">Working with structured data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="WorkingWithStructuredData.html#using-sqlite3">Using SQLite3</a></li>
<li class="toctree-l2"><a class="reference internal" href="WorkingWithStructuredData.html#basic-concepts-of-database-normalization">Basic concepts of database normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="WorkingWithStructuredData.html#using-hdf5">Using HDF5</a></li>
<li class="toctree-l2"><a class="reference internal" href="WorkingWithStructuredData.html#interfacing-withpandas">Interfacing withPandas</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="UsingNumpySolutions.html">Using numpy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#ndarray">NDArray</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#broadcasting-row-column-and-matrix-operations">Broadcasting, row, column and matrix operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#universal-functions-ufuncs">Universal functions (Ufuncs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#generalized-ufucns">Generalized ufucns</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#random-numbers">Random numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#linear-algebra">Linear algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingNumpySolutions.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="UsingPandas.html">Using Pandas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="UsingPandas.html#series">Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingPandas.html#dataframe">DataFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingPandas.html#panels">Panels</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingPandas.html#split-apply-combine">Split-Apply-Combine</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingPandas.html#using-statsmodels">Using statsmodels</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="UsingPandas.html#using-r-from-ipython">Using R from IPython</a><ul>
<li class="toctree-l2"><a class="reference internal" href="UsingPandas.html#using-rmagic">Using Rmagic</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsingPandas.html#using-r-from-pandas">Using R from pandas</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ComputationalStatisticsMotivation.html">Computational problems in statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ComputationalStatisticsMotivation.html#textbook-example-is-coin-fair">Textbook example - is coin fair?</a></li>
<li class="toctree-l2"><a class="reference internal" href="ComputationalStatisticsMotivation.html#bayesian-approach">Bayesian approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="ComputationalStatisticsMotivation.html#comment">Comment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ComputerArithmetic.html">Computer numbers and mathematics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ComputerArithmetic.html#some-examples-of-numbers-behaving-badly">Some examples of numbers behaving badly</a></li>
<li class="toctree-l2"><a class="reference internal" href="ComputerArithmetic.html#finite-representation-of-numbers">Finite representation of numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="ComputerArithmetic.html#using-arbitrary-precision-libraries">Using arbitrary precision libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="ComputerArithmetic.html#from-numbers-to-functions-stability-and-conditioning">From numbers to Functions: Stability and conditioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="ComputerArithmetic.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="AlgorithmicComplexity.html">Algorithmic complexity</a><ul>
<li class="toctree-l2"><a class="reference internal" href="AlgorithmicComplexity.html#profling-and-benchmarking">Profling and benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="AlgorithmicComplexity.html#measuring-algorithmic-complexity">Measuring algorithmic complexity</a></li>
<li class="toctree-l2"><a class="reference internal" href="AlgorithmicComplexity.html#space-complexity">Space complexity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="LinearAlgebraReview.html">Linear Algebra and Linear Systems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#simultaneous-equations">Simultaneous Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#linear-independence">Linear Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#norms-and-distance-of-vectors">Norms and Distance of Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#trace-and-determinant-of-matrices">Trace and Determinant of Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#column-space-row-space-rank-and-kernel">Column space, Row space, Rank and Kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#matrices-as-linear-transformations">Matrices as Linear Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#matrix-norms">Matrix Norms</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#special-matrices">Special Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraReview.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html">Linear Algebra and Matrix Decompositions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html#large-linear-systems">Large Linear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html#example-netflix-competition-circa-2006-2009">Example: Netflix Competition (circa 2006-2009)</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html#matrix-decompositions">Matrix Decompositions</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html#matrix-decompositions-for-pca-and-least-squares">Matrix Decompositions for PCA and Least Squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html#singular-value-decomposition">Singular Value Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html#stabilty-and-condition-number">Stabilty and Condition Number</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebraMatrixDecompWithSolutions.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PCASolutions.html">Change of Basis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="PCASolutions.html#variance-and-covariance">Variance and covariance</a></li>
<li class="toctree-l2"><a class="reference internal" href="PCASolutions.html#eigendecomposition-of-the-covariance-matrix">Eigendecomposition of the covariance matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="PCASolutions.html#pca">PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="PCASolutions.html#change-of-basis-via-pca">Change of basis via PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="PCASolutions.html#graphical-illustration-of-change-of-basis">Graphical illustration of change of basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="PCASolutions.html#dimension-reduction-via-pca">Dimension reduction via PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="PCASolutions.html#using-singular-value-decomposition-svd-for-pca">Using Singular Value Decomposition (SVD) for PCA</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationInOneDimension.html">Optimization and Non-linear Methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="OptimizationInOneDimension.html#example-maximum-likelihood-estimation-mle">Example: Maximum Likelihood Estimation (MLE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="OptimizationInOneDimension.html#bisection-method">Bisection Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="OptimizationInOneDimension.html#secant-method">Secant Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="OptimizationInOneDimension.html#newton-rhapson-method">Newton-Rhapson Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="OptimizationInOneDimension.html#gauss-newton">Gauss-Newton</a></li>
<li class="toctree-l2"><a class="reference internal" href="OptimizationInOneDimension.html#inverse-quadratic-interpolation">Inverse Quadratic Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="OptimizationInOneDimension.html#brent-s-method">Brent&#8217;s Method</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="BlackBoxOptimization.html">Practical Optimizatio Routines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#finding-roots">Finding roots</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#optimization-primer">Optimization Primer</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#using-scipy-optimize">Using <code class="docutils literal"><span class="pre">scipy.optimize</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#gradient-deescent">Gradient deescent</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#newton-s-method-and-variants">Newton&#8217;s method and variants</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#constrained-optimization">Constrained optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#curve-fitting">Curve fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#finding-paraemeters-for-ode-models">Finding paraemeters for ODE models</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#optimization-of-graph-node-placement">Optimization of graph node placement</a></li>
<li class="toctree-l2"><a class="reference internal" href="BlackBoxOptimization.html#optimization-of-standard-statistical-models">Optimization of standard statistical models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="CalibratingODEs.html">Fitting ODEs with the Levenbergâ€“Marquardt algorithm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="CalibratingODEs.html#d-example">1D example</a></li>
<li class="toctree-l2"><a class="reference internal" href="CalibratingODEs.html#id1">2D example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MultivariateOptimizationAlgortihms.html">Algorithms for Optimization and Root Finding for Multivariate Problems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MultivariateOptimizationAlgortihms.html#optimizers">Optimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultivariateOptimizationAlgortihms.html#solvers">Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultivariateOptimizationAlgortihms.html#glm-estimation-and-irls">GLM Estimation and IRLS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="EMAlgorithm.html">Expectation Maximizatio (EM) Algorithm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#jensen-s-inequality">Jensen&#8217;s inequality</a></li>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#maximum-likelihood-with-complete-information">Maximum likelihood with complete information</a></li>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#incomplete-information">Incomplete information</a></li>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#gaussian-mixture-models">Gaussian mixture models</a></li>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#using-em">Using EM</a></li>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#vectorized-version">Vectorized version</a></li>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#vectorization-with-einstein-summation-notation">Vectorization with Einstein summation notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="EMAlgorithm.html#comparison-of-em-routines">Comparison of EM routines</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MonteCarlo.html">Monte Carlo Methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MonteCarlo.html#pseudorandom-number-generators-prng">Pseudorandom number generators (PRNG)</a></li>
<li class="toctree-l2"><a class="reference internal" href="MonteCarlo.html#monte-carlo-swindles-variance-reduction-techniques">Monte Carlo swindles (Variance reduction techniques)</a></li>
<li class="toctree-l2"><a class="reference internal" href="MonteCarlo.html#quasi-random-numbers">Quasi-random numbers</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Resampling methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#resampling">Resampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simulations">Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-the-random-seed">Setting the random seed</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sampling-with-and-without-replacement">Sampling with and without replacement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#calculation-of-cook-s-distance">Calculation of Cook&#8217;s distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#permutation-resampling">Permutation resampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#design-of-simulation-experiments">Design of simulation experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-simulations-to-estimate-power">Example: Simulations to estimate power</a></li>
<li class="toctree-l2"><a class="reference internal" href="#check-with-r">Check with R</a></li>
<li class="toctree-l2"><a class="reference internal" href="#estimating-the-cdf">Estimating the CDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="#estimating-the-pdf">Estimating the PDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="#kernel-density-estimation">Kernel density estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multivariate-kerndel-density-estimation">Multivariate kerndel density estimation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MCMC.html">Markov Chain Monte Carlo (MCMC)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MCMC.html#bayesian-data-analysis">Bayesian Data Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="MCMC.html#metropolis-hastings-sampler">Metropolis-Hastings sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="MCMC.html#gibbs-sampler">Gibbs sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="MCMC.html#slice-sampler">Slice sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="MCMC.html#hierarchical-models">Hierarchical models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PyMC2.html">Using PyMC2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="PyMC2.html#coin-toss">Coin toss</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC2.html#estimating-mean-and-standard-deviation-of-normal-distribution">Estimating mean and standard deviation of normal distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC2.html#estimating-parameters-of-a-linear-regreession-model">Estimating parameters of a linear regreession model</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC2.html#estimating-parameters-of-a-logistic-model">Estimating parameters of a logistic model</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC2.html#using-a-hierarchcical-model">Using a hierarchcical model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PyMC3.html">Using PyMC3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="PyMC3.html#coin-toss">Coin toss</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC3.html#estimating-mean-and-standard-deviation-of-normal-distribution">Estimating mean and standard deviation of normal distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC3.html#estimating-parameters-of-a-linear-regreession-model">Estimating parameters of a linear regreession model</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC3.html#estimating-parameters-of-a-logistic-model">Estimating parameters of a logistic model</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyMC3.html#using-a-hierarchcical-model">Using a hierarchcical model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PyStan.html">Using PyStan</a><ul>
<li class="toctree-l2"><a class="reference internal" href="PyStan.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="PyStan.html#simple-logistic-model">Simple Logistic model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Animation.html">Animations of Metropolis, Gibbs and Slice Sampler dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="CrashCourseInC.html">C Crash Course</a><ul>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#hello-world">Hello world</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#a-tutorial-example-coding-a-fibonacci-function-in-c">A tutorial example - coding a Fibonacci function in C</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#types-in-c">Types in C</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#operators">Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#control-of-program-flow">Control of program flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#arrays-and-pointers">Arrays and pointers</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#function-pointers">Function pointers</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#using-make-to-compile-c-programs">Using make to compile C programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrashCourseInC.html#exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MakingCodeFast.html">Code Optimization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MakingCodeFast.html#profiling">Profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="MakingCodeFast.html#using-better-algorihtms-and-data-structures">Using better algorihtms and data structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="MakingCodeFast.html#i-o-bound-problems">I/O Bound problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="MakingCodeFast.html#problem-set-for-optimization">Problem set for optimization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FromCToPython.html">Using C code in Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="FromCToPython.html#example-the-fibonacci-sequence">Example: The Fibonacci Sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCToPython.html#using-clang-and-bitey">Using clang and bitey</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCToPython.html#using-gcc-and-ctypes">Using gcc and ctypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCToPython.html#using-cython">Using Cython</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCToPython.html#benchmark">Benchmark</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FromCompiledToPython.html">Using functions from various compiled languages in Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="FromCompiledToPython.html#c">C</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCompiledToPython.html#id1">C++</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCompiledToPython.html#fortran">Fortran</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCompiledToPython.html#benchmarking">Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCompiledToPython.html#wrapping-a-function-from-a-c-library-for-use-in-python">Wrapping a function from a C library for use in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromCompiledToPython.html#wrapping-functions-from-c-library-for-use-in-pyton">Wrapping functions from C++ library for use in Pyton</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FromJuliaToPython.html">Julia and Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="FromJuliaToPython.html#defining-a-function-in-julia">Defining a function in Julia</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromJuliaToPython.html#using-it-in-python">Using it in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromJuliaToPython.html#using-python-libraries-in-julia">Using Python libraries in Julia</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FromPythonToC.html">Converting Python Code to C for speed</a><ul>
<li class="toctree-l2"><a class="reference internal" href="FromPythonToC.html#example-fibonacci">Example: Fibonacci</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromPythonToC.html#example-matrix-multiplication">Example: Matrix multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromPythonToC.html#example-pairwise-distance-matrix">Example: Pairwise distance matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromPythonToC.html#profiling-code">Profiling code</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromPythonToC.html#numba">Numba</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromPythonToC.html#cython">Cython</a></li>
<li class="toctree-l2"><a class="reference internal" href="FromPythonToC.html#comparison-with-optimized-c-from-scipy">Comparison with optimized C from scipy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Optimization_Bakeoff.html">Optimization bake-off</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#python-version">Python version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#numpy-version">Numpy version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#numexpr-version">Numexpr version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#numba-version">Numba version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#numbapro-version">NumbaPro version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#parakeet-version">Parakeet version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#cython-version">Cython version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#c-version">C version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#id1">C++ version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#fortran-version">Fortran version</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#bake-off">Bake-off</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="Optimization_Bakeoff.html#recommendations-for-optimizing-python-code">Recommendations for optimizing Python code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="WritingParallelCode.html">Writing Parallel Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="WritingParallelCode.html#concepts">Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="WritingParallelCode.html#embarassingly-parallel-programs">Embarassingly parallel programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="WritingParallelCode.html#using-multiprocessing">Using Multiprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="WritingParallelCode.html#using-ipython-parallel-for-interactive-parallel-computing">Using IPython parallel for interactive parallel computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="WritingParallelCode.html#other-parallel-programming-approaches-not-covered">Other parallel programming approaches not covered</a></li>
<li class="toctree-l2"><a class="reference internal" href="WritingParallelCode.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="CUDAPython.html">Massively parallel programming with GPUs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#programming-gpus">Programming GPUs</a></li>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#gpu-architecture">GPU Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#cuda-python">CUDA Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#getting-started-with-cuda">Getting Started with CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#vector-addition-the-hello-world-of-cuda">Vector addition - the &#8216;Hello, world&#8217; of CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#performing-a-reduction-on-cuda">Performing a reduction on CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#recreational">Recreational</a></li>
<li class="toctree-l2"><a class="reference internal" href="CUDAPython.html#more-examples">More examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="GPUsAndCUDAC.html">Writing CUDA in C</a><ul>
<li class="toctree-l2"><a class="reference internal" href="GPUsAndCUDAC.html#review-of-gpu-architechture-a-simplification">Review of GPU Architechture - A Simplification</a></li>
<li class="toctree-l2"><a class="reference internal" href="GPUsAndCUDAC.html#cuda-c-program-an-outline">Cuda C program - an Outline</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="DistributedComputing.html">Distributed computing for Big Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="DistributedComputing.html#why-and-when-does-distributed-computing-matter">Why and when does distributed computing matter?</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedComputing.html#ingredients-for-effiicient-distributed-computing">Ingredients for effiicient distributed computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedComputing.html#what-is-hadoop">What is Hadoop?</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedComputing.html#review-of-functional-programming">Review of functional programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedComputing.html#the-hadoop-mapreduce-workflow">The Hadoop MapReduce workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedComputing.html#using-hadoop-mapreduce">Using Hadoop MapReduce</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedComputing.html#spark">Spark</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MapReduce.html">Hadoop MapReduce on AWS EMR with <code class="docutils literal"><span class="pre">mrjob</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="MapReduce.html#mapreduce-code">MapReduce code</a></li>
<li class="toctree-l2"><a class="reference internal" href="MapReduce.html#configuration-file">Configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="MapReduce.html#launching-job">Launching job</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Spark.html">Spark on a local mahcine using 4 nodes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Spark.html#using-spark-in-standalone-prograsm">Using Spark in standalone prograsm</a></li>
<li class="toctree-l2"><a class="reference internal" href="Spark.html#introduction-to-spark-concepts-with-a-data-manipulation-example">Introduction to Spark concepts with a data manipulation example</a></li>
<li class="toctree-l2"><a class="reference internal" href="Spark.html#using-the-mllib-for-regression">Using the MLlib for Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="Spark.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ModulesAndPackaging.html">Modules and Packaging</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ModulesAndPackaging.html#modules">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="ModulesAndPackaging.html#distributing-your-package">Distributing your package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Jupyter.html">Tour of the Jupyter (IPython3) notebook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Jupyter.html#installing-jupyter">Installing Jupyter</a></li>
<li class="toctree-l2"><a class="reference internal" href="Jupyter.html#installing-other-kernels">Installing other kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="Jupyter.html#installing-extensions">Installing extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Jupyter.html#installing-python3-while-keeping-python2">Installing Python3 while keeping Python2</a></li>
<li class="toctree-l2"><a class="reference internal" href="Jupyter.html#now-restart-your-notebook-server">Now, restart your notebook server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MultiKernel.html">Polyglot programming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MultiKernel.html#python-2">Python 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultiKernel.html#python-3">Python 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultiKernel.html#bash">Bash</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultiKernel.html#r">R</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultiKernel.html#scala">Scala</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultiKernel.html#julia">Julia</a></li>
<li class="toctree-l2"><a class="reference internal" href="MultiKernel.html#processing">Processing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ReveiwAndTrends.html">What you should know and learn more about</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ReveiwAndTrends.html#statistical-foundations">Statistical foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ReveiwAndTrends.html#computing-foundations">Computing foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ReveiwAndTrends.html#mathematical-foundations">Mathematical foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ReveiwAndTrends.html#statistical-algorithms">Statistical algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="ReveiwAndTrends.html#libraries-worth-knowing-about-after-numpy-scipy-and-matplotlib">Libraries worth knowing about after numpy, scipy and matplotlib</a></li>
</ul>
</li>
</ul>
</ul>
<form action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9">
      
  <div class="code python highlight-python"><div class="highlight"><pre>from __future__ import division
import os
import sys
import glob
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
%matplotlib inline
%precision 4
plt.style.use(&#39;ggplot&#39;)
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">formatter</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;float&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">&#39;</span><span class="si">%.3f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">})</span>
</pre></div>
</div>
<div class="section" id="resampling-methods">
<h1>Resampling methods<a class="headerlink" href="#resampling-methods" title="Permalink to this headline">Â¶</a></h1>
<div class="section" id="resampling">
<h2>Resampling<a class="headerlink" href="#resampling" title="Permalink to this headline">Â¶</a></h2>
<ul class="simple">
<li>Sampling with and without replacement</li>
<li>Bootstrap (using sampling with replacement)</li>
<li>Jackknife (using subsets)</li>
<li>Cross validation and LOOCV (using subsets)</li>
<li>Permutation resampling (switching labels)</li>
</ul>
</div>
<div class="section" id="simulations">
<h2>Simulations<a class="headerlink" href="#simulations" title="Permalink to this headline">Â¶</a></h2>
<ul class="simple">
<li>Design of experiments</li>
<li>Power from simulations</li>
<li>Hypothesis testing from simulations</li>
<li>Empirical CDF</li>
<li>Density estimation</li>
</ul>
</div>
<div class="section" id="setting-the-random-seed">
<h2>Setting the random seed<a class="headerlink" href="#setting-the-random-seed" title="Permalink to this headline">Â¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id1">
<h3>Resampling<a class="headerlink" href="#id1" title="Permalink to this headline">Â¶</a></h3>
</div>
</div>
<div class="section" id="sampling-with-and-without-replacement">
<h2>Sampling with and without replacement<a class="headerlink" href="#sampling-with-and-without-replacement" title="Permalink to this headline">Â¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Sampling is done with replacement by default</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Probability weights can be given</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">4</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">x</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># sampling individual elements</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># sampling rows</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># sampling columns</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">x</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Give the argument replace=False</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">e</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Cannot take a larger sample than population when &#39;replace=False&#39;
</pre></div>
</div>
<p>You will likely have used this for the stochastic gradient descent
homework.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">x</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Shuffling occurs &quot;in place&quot; for efficiency</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># To shuffle columns instead, transpose before shuffling</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># numpy.random.permutation does the same thing but returns a copy</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># When given an integre n, permutation treats is as the array arange(n)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Use indices if you needed to shuffle collections of arrays in synchrony</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">10</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">print</span> <span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:],</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
<span class="k">print</span> <span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>[[ 9 10 11]
 [ 3  4  5]
 [ 6  7  8]
 [ 0  1  2]]

[[19 20 21]
 [13 14 15]
 [16 17 18]
 [10 11 12]]
</pre></div>
</div>
<div class="section" id="bootstrap">
<h3>Bootstrap<a class="headerlink" href="#bootstrap" title="Permalink to this headline">Â¶</a></h3>
<p>The bootstrap is commonly used to estimate statistics when theory fails.
We have already seen the bootstrap for estiamting confidence bounds for
convergence in the Monte Carlo integration.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># For example, what is the 95% confidence interval for</span>
<span class="c"># the mean of this data set if you didn&#39;t know how it was generated?</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s">&#39;step&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_24_0.png" src="_images/ResamplingAndMonteCarloSimulations_24_0.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">reps</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">xb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">reps</span><span class="p">))</span>
<span class="n">mb</span> <span class="o">=</span> <span class="n">xb</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mb</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">mb</span><span class="p">,</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([</span><span class="mf">0.483</span><span class="p">,</span> <span class="mf">0.740</span><span class="p">])</span>
</pre></div>
</div>
<div class="section" id="reprise-of-bootstrap-example-for-monte-carlo-integration">
<h4>Reprise of bootstrap example for Monte Carlo integration<a class="headerlink" href="#reprise-of-bootstrap-example-for-monte-carlo-integration" title="Permalink to this headline">Â¶</a></h4>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">71</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">13</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># data sample for integration</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># bootstrap MC integration</span>
<span class="n">reps</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">xb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">reps</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">yb</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)[:,</span> <span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">upper</span><span class="p">,</span> <span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">yb</span><span class="p">,</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)[:,</span> <span class="bp">None</span><span class="p">],</span> <span class="n">yb</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">yb</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">upper</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">lower</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_30_0.png" src="_images/ResamplingAndMonteCarloSimulations_30_0.png" />
</div>
</div>
<div class="section" id="leave-some-out-resampling">
<h3>Leave some-out resampling<a class="headerlink" href="#leave-some-out-resampling" title="Permalink to this headline">Â¶</a></h3>
<div class="section" id="jackknife-estimate-of-parameters">
<h4>Jackknife estimate of parameters<a class="headerlink" href="#jackknife-estimate-of-parameters" title="Permalink to this headline">Â¶</a></h4>
<p>This shows the leave-one-out calculation idiom for Python. Unlike R, a
-k index to an array does not delete the kth entry, but returns the kth
entry from the end, so we need another way to efficiently drop one
scalar or vector. This can be done using Boolean indexing as shown in
the examples below, and is efficient since the operations are on <em>views</em>
of the origianl array rather thna <em>copies</em>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">jackknife</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Jackknife estimate of the estimator func&quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="o">!=</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Jackknife estimate of standard deviation</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">jackknife</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">1.9223</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">jackknife_var</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Jackknife estiamte of the variance of the estimator func.&quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">j_est</span> <span class="o">=</span> <span class="n">jackknife</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="o">!=</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">j_est</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span>
                                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># estimate of the variance of an estimator</span>
<span class="n">jackknife_var</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">0.0254</span>
</pre></div>
</div>
</div>
<div class="section" id="leave-one-out-cross-validation-loocv">
<h4>Leave one out cross validation (LOOCV)<a class="headerlink" href="#leave-one-out-cross-validation-loocv" title="Permalink to this headline">Â¶</a></h4>
<p>LOOCV also uses the same idiom, and a simple example of LOOCV for model
selection is illustrated.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">deg</span><span class="p">)</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;r:o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s">&#39;b-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Degree = </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">deg</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_39_0.png" src="_images/ResamplingAndMonteCarloSimulations_39_0.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">loocv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fit</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">deg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;LOOCV RSS for fitting a polynomial model.&quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">rss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([(</span><span class="n">y</span> <span class="o">-</span> <span class="n">pred</span><span class="p">(</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="o">!=</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="o">!=</span><span class="n">i</span><span class="p">],</span> <span class="n">deg</span><span class="p">),</span> <span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="mf">2.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">rss</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># RSS does not detect overfitting and selects the most complex model</span>
<span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&#39;Degree = </span><span class="si">%d</span><span class="s">, RSS=</span><span class="si">%.2f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">deg</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="p">),</span> <span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="mf">2.0</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Degree</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">59.90</span>
<span class="n">Degree</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">6.20</span>
<span class="n">Degree</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">6.20</span>
<span class="n">Degree</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">6.20</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># LOOCV selects the correct model</span>
<span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&#39;Degree = </span><span class="si">%d</span><span class="s">, RSS=</span><span class="si">%.2f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">deg</span><span class="p">,</span> <span class="n">loocv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">,</span> <span class="n">deg</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Degree</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">628.41</span>
<span class="n">Degree</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">64.35</span>
<span class="n">Degree</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">67.81</span>
<span class="n">Degree</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">85.39</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="calculation-of-cook-s-distance">
<h2>Calculation of Cook&#8217;s distance<a class="headerlink" href="#calculation-of-cook-s-distance" title="Permalink to this headline">Â¶</a></h2>
<p>Cook&#8217;s distance is used to estimate the influence of a data point when
performing least squares regression analysis. It is one of the standard
plots for linear regression in R and provides another example of the
applicationof leave-one-out resampling.</p>
<div class="math">
\[D_i = \frac{\sum_{j=1}^n (\hat Y_j - \hat Y_{j(i)})^2}{p\  \text{MSE}}\]</div>
<p>The calculation of Cook&#8217;s distance involves the fitting of <span class="math">\(n\)</span>
regression models, so we want to do this as efficiently as possible.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">cook_dist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Vectorized version of Cook&#39;s distance.&quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">fitted</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="n">yhat</span> <span class="o">=</span> <span class="n">fitted</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fitted</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">yhat</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">mse</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">yhat</span> <span class="o">-</span> <span class="n">model</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="o">!=</span><span class="n">i</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">idx</span><span class="o">!=</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span><span class="o">/</span><span class="n">denom</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="kn">as</span> <span class="nn">sm</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># create data set with outliers</span>
<span class="n">nobs</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">nobs</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">beta</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">]</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">nobs</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span> <span class="o">+</span> <span class="n">e</span>
<span class="n">y</span><span class="p">[[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">78</span><span class="p">]]</span> <span class="o">*=</span> <span class="mi">3</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># use Cook&#39;s distance to identify outliers</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">cook_dist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">d</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_48_0.png" src="_images/ResamplingAndMonteCarloSimulations_48_0.png" />
</div>
<div class="section" id="permutation-resampling">
<h2>Permutation resampling<a class="headerlink" href="#permutation-resampling" title="Permalink to this headline">Â¶</a></h2>
<p>Permuatation resampling is used ot generate the null distribtuion of
labeled data by switching lebals. Because the number of permuations
grows so fast, it is typically only feasible to use a Monte Carlo sample
of the possible set of permuations in computation.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Growth of the factorial function (number of permutations) using Stirling&#39;s approximation</span>

<span class="k">def</span> <span class="nf">stirling</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Stirling&#39;s approximation to the factorial.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="p">)</span><span class="o">**</span><span class="n">n</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="nb">zip</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">stirling</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.9221</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.9190</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">5.8362</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">23.5062</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">118.0192</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">710.0782</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mf">4980.3958</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">39902.3955</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mf">359536.8728</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">3598695.6187</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mf">39615625.0506</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">475687486.4728</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mf">6187239475.1927</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mf">86661001740.5988</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mf">1300430722199.4680</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mf">20814114415223.1367</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mf">353948328666101.1250</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mf">6372804626194313.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mf">121112786592294192.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mf">2422786846761135104.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mf">50888617325509746688.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mf">1119751494628237770752.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mf">25758525370529310834688.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mf">618297927022794799841280.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mf">15459594834691181359661056.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">26</span><span class="p">,</span> <span class="mf">402000993060955330726330368.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">27</span><span class="p">,</span> <span class="mf">10855315170319531497075245056.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mf">303982326243341862218743414784.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">29</span><span class="p">,</span> <span class="mf">8816392105377489957715009601536.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">264517095922965156800687262138368.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mf">8200764697241122458512884083195904.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mf">262446514081933026899914856968749056.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mf">8661418381417958431306228879169945600.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">34</span><span class="p">,</span> <span class="mf">294510096099824346859521185203942850560.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mf">10308575166584033336103974733365808988160.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mf">371133249087415837775601850534254065221632.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">37</span><span class="p">,</span> <span class="mf">13732789283357647537712986585599118967570432.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mf">521876921190057472102855717030406837275459584.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">39</span><span class="p">,</span> <span class="mf">20354344348300692639357061611803222912972881920.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mf">814217264494623640116433847565750863601126604800.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="mf">33384604069916415591100983328410827967169870954496.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mf">1402221223524367565643573793611811471275760323395584.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="mf">60298294706657120904833322706173396147148627061506048.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">44</span><span class="p">,</span> <span class="mf">2653241820650555398466033792063490393009887673090834432.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mf">119400906860443613913174999733586801766394224950600794112.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">46</span><span class="p">,</span> <span class="mf">5492662822140225801570025546069546965027287393900087476224.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">47</span><span class="p">,</span> <span class="mf">258165102848257451938594016029422319832480942931582618959872.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mf">12392382664425307299255962057935500269489259106719931528380416.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">49</span><span class="p">,</span> <span class="mf">607248264576510288229888440783681300390904221083157786483752960.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mf">30363445939381680077841740787498028998394965264769813642857152512.0000</span><span class="p">)]</span>
</pre></div>
</div>
<p>Suppose you have 2 data sets from unknown distribution and you want to
test if some arbitrary statistic (e.g 7th percentile) is the same in the
2 data sets - what can you do?</p>
<p>An appropirate test statistic is the difference between the 7th
percentile, and if we knew the null distribution of this statisic, we
could test for the null hypothesis that the statistic = 0. Permuting the
labels of the 2 data sets allows us to create the empirical null
distribution.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">250</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="n">reps</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
<span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">n2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">)])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">xp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">ps</span><span class="p">[:,</span> <span class="p">:</span><span class="n">n1</span><span class="p">]]</span>
<span class="n">yp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">ps</span><span class="p">[:,</span> <span class="n">n1</span><span class="p">:]]</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">yp</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s">&#39;step&#39;</span><span class="p">)</span>
<span class="n">test_stat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">test_stat</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;--&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;p-value =&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">samples</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">test_stat</span><span class="p">))</span><span class="o">/</span><span class="n">reps</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mf">0.0124</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_55_1.png" src="_images/ResamplingAndMonteCarloSimulations_55_1.png" />
<p>We will make up some data - a tpical example is trying to identify genes
that are differentially expressed in two groups of people, pehraps those
who are helathy and those who are sick. For each gene, we can perform a
t-test to see if the gene is differnetially expressed across the two
groups at some nominal significanc level, typically 0.05. When we have
many genes, this is unsatisfactory since 5% of the genes will be found
to be differentially expressed just by chance.</p>
<p>One possible solution is to use the family-wise error rate instead -
most simply using the Bonferroni adjusted p-value. An alternative is to
use the non-parmaetric method originally proposed by Young and Westfall
that uses permuation resampling to estimate the adjusted p-value without
the assumptions of independence that the Bonferroni method makes.</p>
<p>See <a class="reference external" href="http://www3.stat.sinica.edu.tw/statistica/oldpdf/A12n16.pdf">http://www3.stat.sinica.edu.tw/statistica/oldpdf/A12n16.pdf</a> for an
overview of statistical procedures in the context of gene expressiona
array analysis, including descriptions of the p-value ajdustements shown
here.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span>

<span class="n">ngenes</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ncases</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">nctrls</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">nsamples</span> <span class="o">=</span> <span class="n">ncases</span> <span class="o">+</span> <span class="n">nctrls</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">ngenes</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="kn">as</span> <span class="nn">st</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">t</span><span class="p">,</span> <span class="n">p0</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:</span><span class="n">ncases</span><span class="p">],</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">ncases</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">p0</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
<span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">idx</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p0</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0119</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.0368</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mf">0.0117</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mf">0.0144</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">39</span><span class="p">,</span> <span class="mf">0.0247</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">44</span><span class="p">,</span> <span class="mf">0.0051</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">68</span><span class="p">,</span> <span class="mf">0.0253</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">97</span><span class="p">,</span> <span class="mf">0.0366</span><span class="p">)]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">vmin</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:</span><span class="n">ncases</span><span class="p">],</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">,</span>
           <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">&#39;jet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Controls&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">ncases</span><span class="p">:],</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">,</span>
           <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">&#39;jet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Cases&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_62_0.png" src="_images/ResamplingAndMonteCarloSimulations_62_0.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">ngenes</span> <span class="o">*</span> <span class="n">p0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
<span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">idx</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[]</span>
</pre></div>
</div>
<p>The basic idea of resampling based p-value adjustemnt is quite simple to
understand. Suppose we want to know the ajdusted p-value for the lowest
observed p-value.</p>
<p>Repeat B times</p>
<ul class="simple">
<li>Permutate the case control labels</li>
<li>Calcuate the lowest p-value for the permutted data</li>
</ul>
<p>The adjusted p-value is simply the number of permutation samples in
which the lowest permuted p-value is smaller than the observed lowest
p-value, divided by the number of permutations.</p>
<p>The next lowest adjusted p-value is more complicated, since we need to
maintain the ordering (i.e the second adjusted p-value must be larger
than the smallest adjusted p-value), and one of several related
algorithms developed by Young and Westfall is usually used. We will not
cover this in this class as the goal is to understand how permuation
resampling works rather than the complexiities of correcting for
multiple testing, but an implementation is provided for those
interested.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Let&#39;s see if the smallest adjusted p-value is significant</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">p0s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">p0</span><span class="p">))</span>
<span class="k">print</span> <span class="s">&quot;Gene</span><span class="se">\t</span><span class="s">Unadjusted p&quot;</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">p0</span><span class="p">)[</span><span class="n">k</span><span class="p">],</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">p0s</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Gene        Unadjusted p
44  0.00509946274404
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Do many permutations</span>
<span class="n">nperms</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nperms</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nperms</span><span class="p">):</span>
    <span class="n">sidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">nsamples</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">sidx</span><span class="p">]</span>
    <span class="n">pvals</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="p">:</span><span class="n">ncases</span><span class="p">],</span> <span class="n">y</span><span class="p">[:,</span> <span class="n">ncases</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">pvals</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">ps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pvals</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

<span class="k">print</span> <span class="s">&quot;Gene</span><span class="se">\t</span><span class="s">Unadjusted p</span><span class="se">\t\t</span><span class="s">Adjusted p&quot;</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">p0</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">p0s</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ps</span> <span class="o">&lt;</span> <span class="n">p0s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="n">nperms</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Gene        Unadjusted p            Adjusted p
0   0.00509946274404        0.4016
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># This is the maxT step-down method</span>
<span class="c"># Assumes that the distribution of T-statistics is the same for all genes</span>

<span class="n">nperms</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">ngenes</span>

<span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nperms</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
<span class="n">ranks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nperms</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">sidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">nsamples</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">sidx</span><span class="p">]</span>
    <span class="n">tb</span><span class="p">,</span> <span class="n">pb</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="p">:</span><span class="n">ncases</span><span class="p">],</span> <span class="n">y</span><span class="p">[:,</span> <span class="n">ncases</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">u</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tb</span><span class="p">[</span><span class="n">ranks</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tb</span><span class="p">[</span><span class="n">ranks</span><span class="p">[</span><span class="n">j</span><span class="p">]]))</span>
    <span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">ranks</span><span class="p">]))</span>

<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">nperms</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">p2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">p2</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
<span class="nb">zip</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">p2</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">p0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;No correction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">p1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Bonferroni&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">p2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Westfall-Young&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_70_0.png" src="_images/ResamplingAndMonteCarloSimulations_70_0.png" />
<p>The Bonferrroni assumes that tests are independent. However, often test
resutls are strongly correlated (e.g. genes in the same pathway behave
similalry) and the Bonferroni will be too conservative. However the
permuation-resampling method still works in the presence of
correaltions.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span>

<span class="n">ngenes</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ncases</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">nctrls</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">nsamples</span> <span class="o">=</span> <span class="n">ncases</span> <span class="o">+</span> <span class="n">nctrls</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">)),</span> <span class="n">ngenes</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># In this extreme case, we measure the same gene 100 times</span>
<span class="n">x</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mf">0.519</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.269</span><span class="p">,</span> <span class="mf">0.240</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.804</span><span class="p">,</span> <span class="mf">0.017</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.519</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.269</span><span class="p">,</span> <span class="mf">0.240</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.804</span><span class="p">,</span> <span class="mf">0.017</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.519</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.269</span><span class="p">,</span> <span class="mf">0.240</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.804</span><span class="p">,</span> <span class="mf">0.017</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.519</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.269</span><span class="p">,</span> <span class="mf">0.240</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.804</span><span class="p">,</span> <span class="mf">0.017</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.519</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.269</span><span class="p">,</span> <span class="mf">0.240</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.804</span><span class="p">,</span> <span class="mf">0.017</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">t</span><span class="p">,</span> <span class="n">p0</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:</span><span class="n">ncases</span><span class="p">],</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">ncases</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">p0</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
<span class="k">print</span> <span class="s">&#39;Minimum p-value&#39;</span><span class="p">,</span> <span class="n">p0</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="s">&#39;# significant&#39;</span><span class="p">,</span> <span class="n">idx</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Minimum p-value 0.0119317780363 # significant 100
</pre></div>
</div>
<p>Bonferroni tells us none of the adjusted p-values are significant, which
we know is the wrong answer.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span> <span class="o">*</span> <span class="n">p0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
<span class="k">print</span> <span class="s">&#39;Minimum p-value&#39;</span><span class="p">,</span> <span class="n">p1</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="s">&#39;# significant&#39;</span><span class="p">,</span> <span class="n">idx</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Minimum p-value 1.0 # significant 0
</pre></div>
</div>
<p>This tells us that every gene is significant, which is the correct
answer.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">nperms</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nperms</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
<span class="n">ranks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nperms</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">sidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">nsamples</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">sidx</span><span class="p">]</span>
    <span class="n">tb</span><span class="p">,</span> <span class="n">pb</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="p">:</span><span class="n">ncases</span><span class="p">],</span> <span class="n">y</span><span class="p">[:,</span> <span class="n">ncases</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">u</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tb</span><span class="p">[</span><span class="n">ranks</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tb</span><span class="p">[</span><span class="n">ranks</span><span class="p">[</span><span class="n">j</span><span class="p">]]))</span>
    <span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">ranks</span><span class="p">]))</span>

<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">nperms</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">p2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">p2</span> <span class="o">&lt;</span> <span class="mf">0.05</span>

<span class="k">print</span> <span class="s">&#39;Minimum p-value&#39;</span><span class="p">,</span> <span class="n">p2</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="s">&#39;# significant&#39;</span><span class="p">,</span> <span class="n">idx</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Minimum p-value 0.0118 # significant 100
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">p1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Bonferroni&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">p2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Westfall-Young&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_80_0.png" src="_images/ResamplingAndMonteCarloSimulations_80_0.png" />
<div class="section" id="monte-carlo-simulations">
<h3>Monte Carlo Simulations<a class="headerlink" href="#monte-carlo-simulations" title="Permalink to this headline">Â¶</a></h3>
</div>
</div>
<div class="section" id="design-of-simulation-experiments">
<h2>Design of simulation experiments<a class="headerlink" href="#design-of-simulation-experiments" title="Permalink to this headline">Â¶</a></h2>
<p>Some experimental design routines (e.g. factorial, latin hypercube
samplign) are proived in
<a class="reference external" href="http://pythonhosted.org//pyDOE/index.html">PyDOE</a></p>
<p>From
<a class="reference external" href="http://www4.stat.ncsu.edu/~davidian/st810a/simulation_handout.pdf">notes</a>
by Marie Dravidian</p>
<p>A Monte Carlo simulation is just like any other experiment</p>
<ul class="simple">
<li>Careful planning is required</li>
<li>Factors that are of interest to vary in the experiment: sample size
n, distribution of the data, magnitude of variation, . . .</li>
<li>Each combination of factors is a separate simulation, so that many
factors can lead to very large number of combinations and thus number
of simulations may be time consuming</li>
<li>Can use experimental design principles</li>
<li>Results must be recorded and saved in a systematic, sensible way</li>
<li>Donâ€™t only choose factors favorable to a method you have developed!</li>
<li>Sample size S (number of data sets) must deliver acceptable precision</li>
</ul>
</div>
<div class="section" id="example-simulations-to-estimate-power">
<h2>Example: Simulations to estimate power<a class="headerlink" href="#example-simulations-to-estimate-power" title="Permalink to this headline">Â¶</a></h2>
<p>What sample size is needed for the t-test to have a power of 0.8 with an
effect size of 0.5?</p>
<p>This is a toy example, since you can just use a pakcage to calculate it,
but the simulation approach works for <em>everything</em>, including
arbitrarily complex experimental designs, correcting for multiple
comparisons and so on(assuming infinite computational resources and you
have some prior knowledge of the likely distribution of simulation
parameters).</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Run nresps simulations</span>
<span class="c"># The power is simply the fraction of reps where</span>
<span class="c"># the p-value is less than 0.05</span>

<span class="n">nreps</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">power</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">power</span> <span class="o">&lt;</span> <span class="mf">0.8</span><span class="p">:</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">n</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">nreps</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">n2</span><span class="p">,</span> <span class="n">nreps</span><span class="p">))</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">power</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">nreps</span>
    <span class="k">print</span> <span class="n">n</span><span class="p">,</span> <span class="n">power</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>50 0.7002
51 0.706
52 0.7119
53 0.7181
54 0.7344
55 0.7351
56 0.7405
57 0.7583
58 0.761
59 0.7647
60 0.775
61 0.7878
62 0.7865
63 0.7913
64 0.8004
</pre></div>
</div>
</div>
<div class="section" id="check-with-r">
<h2>Check with R<a class="headerlink" href="#check-with-r" title="Permalink to this headline">Â¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre>%load_ext rpy2.ipython
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre>%%R
install.packages(&quot;pwr&quot;, repos =&quot;http://cran.us.r-project.org&quot;)
library(pwr)

power.t.test(sig.level=0.05, power=0.8, delta = 0.5)
</pre></div>
</div>
<pre class="literal-block">
trying URL '<a class="reference external" href="http://cran.us.r-project.org/bin/macosx/mavericks/contrib/3.1/pwr_1.1-2.tgz">http://cran.us.r-project.org/bin/macosx/mavericks/contrib/3.1/pwr_1.1-2.tgz</a>'
Content type 'application/x-gzip' length 53156 bytes (51 Kb)
opened URL
==================================================
downloaded 51 Kb


The downloaded binary packages are in
    /var/folders/xf/rzdg30ps11g93j3w0h589q780000gn/T//RtmpWSpKKL/downloaded_packages

     Two-sample t test power calculation

              n = 63.76576
          delta = 0.5
             sd = 1
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number in <em>each</em> group
</pre>
<div class="section" id="characterizing-monte-carlo-samples">
<h3>Characterizing Monte Carlo samples<a class="headerlink" href="#characterizing-monte-carlo-samples" title="Permalink to this headline">Â¶</a></h3>
<p>Given a bunch of random numbers from a simulaiton experiment, one of the
first steps is to visualize the CDF and PDF.</p>
</div>
</div>
<div class="section" id="estimating-the-cdf">
<h2>Estimating the CDF<a class="headerlink" href="#estimating-the-cdf" title="Permalink to this headline">Â¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Make up some random data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Roll our own ECDF function</span>

<span class="k">def</span> <span class="nf">ecdf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return empirical CDF of x.&quot;&quot;&quot;</span>

    <span class="n">sx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sx</span><span class="p">)))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">sx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sx</span><span class="p">,</span> <span class="n">cdf</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">sx</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ecdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_93_0.png" src="_images/ResamplingAndMonteCarloSimulations_93_0.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">statsmodels.distributions.empirical_distribution</span> <span class="kn">import</span> <span class="n">ECDF</span>

<span class="n">ecdf</span> <span class="o">=</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ecdf</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ecdf</span><span class="o">.</span><span class="n">y</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_95_0.png" src="_images/ResamplingAndMonteCarloSimulations_95_0.png" />
</div>
<div class="section" id="estimating-the-pdf">
<h2>Estimating the PDF<a class="headerlink" href="#estimating-the-pdf" title="Permalink to this headline">Â¶</a></h2>
<p>The simplest is to plot a normalized histogram as shown above, but we
will also look at how to estimate density functions using kernel density
estimation.</p>
</div>
<div class="section" id="kernel-density-estimation">
<h2>Kernel density estimation<a class="headerlink" href="#kernel-density-estimation" title="Permalink to this headline">Â¶</a></h2>
<p>Kernel density estimation is a form of convolution, usually with a
symmetric kenrel (e.g. a Gaussian). The degree of smoothing is
determined by a bandwidth parameter.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">epanechnikov</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Epanechnikov kernel.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">u</span><span class="o">*</span><span class="n">u</span><span class="o">/</span><span class="mf">5.0</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">silverman</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Find bandwidth using heuristic suggested by Silverman</span>
<span class="sd">    .9 min(standard deviation, interquartile range/1.34)n-1/5</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">iqr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="mi">75</span><span class="p">,</span> <span class="mi">25</span><span class="p">]))</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">y</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">iqr</span><span class="o">/</span><span class="mf">1.34</span><span class="p">])</span><span class="o">*</span><span class="n">n</span><span class="o">**-</span><span class="mf">0.2</span>
    <span class="k">return</span> <span class="n">h</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">kde</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="n">silverman</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="n">epanechnikov</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns kernel density estimate.</span>
<span class="sd">    x are the points for evaluation</span>
<span class="sd">    y is the data to be fitted</span>
<span class="sd">    bandwidth is a function that returens the smoothing parameter h</span>
<span class="sd">    kernel is a function that gives weights to neighboring data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">bandwidth</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">kernel</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">[:,</span> <span class="bp">None</span><span class="p">])</span><span class="o">/</span><span class="n">h</span><span class="p">)</span><span class="o">/</span><span class="n">h</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">density</span> <span class="o">=</span> <span class="n">kde</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">density</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_101_0.png" src="_images/ResamplingAndMonteCarloSimulations_101_0.png" />
<p>There are several kernel density estimation routines available in scipy,
statsmodels and scikit-leran. Here we will use the scikits-learn and
statsmodels routine as examples.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="kn">as</span> <span class="nn">sm</span>

<span class="n">dens</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">nonparametric</span><span class="o">.</span><span class="n">KDEUnivariate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">dens</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s">&#39;gau&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">dens</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">xs</span><span class="p">));</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_103_0.png" src="_images/ResamplingAndMonteCarloSimulations_103_0.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KernelDensity</span>

<span class="c"># expects n x p matrix with p features</span>
<span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">xs</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">kde</span> <span class="o">=</span> <span class="n">KernelDensity</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s">&#39;epanechnikov&#39;</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">dens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kde</span><span class="o">.</span><span class="n">score_samples</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">dens</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_104_0.png" src="_images/ResamplingAndMonteCarloSimulations_104_0.png" />
</div>
<div class="section" id="multivariate-kerndel-density-estimation">
<h2>Multivariate kerndel density estimation<a class="headerlink" href="#multivariate-kerndel-density-estimation" title="Permalink to this headline">Â¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># create data set</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">_mus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">_sigmas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]]])</span>
<span class="n">_pis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">pi</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_pis</span><span class="p">,</span> <span class="n">_mus</span><span class="p">,</span> <span class="n">_sigmas</span><span class="p">)])</span>

<span class="n">kde</span> <span class="o">=</span> <span class="n">KernelDensity</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s">&#39;gaussian&#39;</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">dens</span> <span class="o">=</span> <span class="n">kde</span><span class="o">.</span><span class="n">score_samples</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">dens</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_106_0.png" src="_images/ResamplingAndMonteCarloSimulations_106_0.png" />
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>