<!DOCTYPE html>
<!-- saved from url=(0078)https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html -->
<html xmlns="http://www.w3.org/1999/xhtml" class="cye-disabled cye-lm"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    
    <title>Resampling methods — Computational Statistics in Python 0.1 documentation</title>
    
    <script type="text/javascript" nonce="622307b16997404bb693cc49c3e" src="https://local.adguard.org/?ts=1624535545232&amp;type=content-script&amp;dmn=people.duke.edu&amp;css=1&amp;js=1&amp;gcss=1&amp;rel=1&amp;rji=1&amp;stealth=1&amp;uag=&amp;trref=aHR0cHM6Ly9wZW9wbGUuZHVrZS5lZHUv"></script>
<script type="text/javascript" nonce="622307b16997404bb693cc49c3e" src="https://local.adguard.org/?ts=1624535545232&amp;name=AdGuard%20Extra%20Beta&amp;type=user-script"></script><link rel="stylesheet" href="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/basic.css" type="text/css">
    <link rel="stylesheet" href="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/pygments.css" type="text/css">
    <link rel="stylesheet" href="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/bootstrap-sphinx.css" type="text/css">
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script><style id="nightModeStyle">
html.cye-enabled.cye-nm:not(*:-webkit-full-screen) body,
 html.cye-enabled.cye-nm:not(*:-webkit-full-screen) #cye-workaround-body {-webkit-filter:contrast(91%) brightness(84%) invert(1);}</style><style id="cyebody">html.cye-enabled.cye-lm body{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;}</style><style id="cyediv">html.cye-enabled.cye-lm div{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;}</style><style id="cyetable">html.cye-enabled.cye-lm th{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;}html.cye-enabled.cye-lm td{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;}</style><style id="cyetextInput">html.cye-enabled.cye-lm input[type=text]{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;}html.cye-enabled.cye-lm textarea{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;}</style><style id="cyeselect">html.cye-enabled.cye-lm select{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;}</style><style id="cyeul">html.cye-enabled.cye-lm ul{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;}</style><style id="cyeChangeByClick">html.cye-enabled.cye-lm .cye-lm-tag,html.cye-enabled.cye-lm.cye-lm-tag{background-color:#cce8cf !important;border-color:rgb(51, 58, 51) !important;background-image:none !important;}</style>
    <script type="text/javascript" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/jquery.js"></script>
    <script type="text/javascript" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/underscore.js"></script>
    <script type="text/javascript" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/doctools.js"></script>
    <script src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/MathJax.js" id=""></script>
    <script type="text/javascript" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/jquery-fix.js"></script>
    <script type="text/javascript" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/bootstrap.min.js"></script>
    <script type="text/javascript" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/bootstrap-sphinx.js"></script>
    <link rel="top" title="Computational Statistics in Python 0.1 documentation" href="https://people.duke.edu/~ccc14/sta-663/index.html">
    <link rel="next" title="Markov Chain Monte Carlo (MCMC)" href="https://people.duke.edu/~ccc14/sta-663/MCMC.html">
    <link rel="prev" title="Monte Carlo Methods" href="https://people.duke.edu/~ccc14/sta-663/MonteCarlo.html">

<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">

  <style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head><div id="cyeBlackMaskLayer" style="background-color: rgb(19, 19, 19); position: fixed; width: 1980px; height: 1080px; z-index: -2147483648;"></div>
  <body role="document" data-new-gr-c-s-check-loaded="14.1018.0" data-gr-ext-installed="" style=""><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><div id="pratikabuSTTDiv" class="pratikabusttdiv-no-print" style="bottom: 20px; right: 20px; opacity: 1; display: block;"><img id="pratikabuSTTArrowUp" style="float: right; opacity: 0.5; cursor: pointer; width: 32px; height: 32px;" class="pratikabuSTTImg pratikabuSTTRotate180" src="chrome-extension://hegiignepmecppikdlbohnnbfjdoaghj/icons/pratikabu-stt-32-1.png"><div id="pratikabuSTTDiv2" class="pratikabusttdiv-no-print" style="width: 16px; opacity: 0; display: block; margin-left: 0px;"><img id="pratikabuSTTClear" class="pratikabuSTTImg" style="opacity: 0.5; cursor: pointer;" src="chrome-extension://hegiignepmecppikdlbohnnbfjdoaghj/icons/pratikabu-stt-clear-16.png"><img id="pratikabuSTTSettings" class="pratikabuSTTImg" style="opacity: 0.5; cursor: pointer;" src="chrome-extension://hegiignepmecppikdlbohnnbfjdoaghj/icons/pratikabu-stt-settings-16.png"></div></div>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="https://people.duke.edu/~ccc14/sta-663/index.html">
          Computational Statistics in Python</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button" id="dLabelGlobalToc" data-toggle="dropdown" data-target="#" href="https://people.duke.edu/~ccc14/sta-663/index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc" role="menu" aria-labelledby="dLabelGlobalToc"><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html" tabindex="-1">Introduction to Python</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#variables">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#operators">Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#iterators">Iterators</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#conditional-statements">Conditional Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#strings-and-string-handling">Strings and String Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#lists-tuples-dictionaries">Lists, Tuples, Dictionaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#classes">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#modules">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#the-standard-library">The standard library</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#keeping-the-anaconda-distribution-up-to-date">Keeping the Anaconda distribution up-to-date</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#exercises">Exercises</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IPythonNotebookIntroduction.html" tabindex="-1">Getting started with Python and the IPython notebook</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IPythonNotebookIntroduction.html#cells">Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IPythonNotebookIntroduction.html#code-cells">Code Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IPythonNotebookIntroduction.html#magic-commands">Magic Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IPythonNotebookIntroduction.html#python-as-glue">Python as Glue</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IPythonNotebookIntroduction.html#python-r-matlab-octave">Python &lt;-&gt; R &lt;-&gt; Matlab &lt;-&gt; Octave</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IPythonNotebookIntroduction.html#more-glue-julia-and-perl">More Glue: Julia and Perl</a></li>
</ul>
</li><li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html">Functions are first class objects</a></li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#function-argumnents" tabindex="-1">Function argumnents</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#call-by-object-reference">Call by “object reference”</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#binding-of-default-arguments-occurs-at-function-definition">Binding of default arguments occurs at function <em>definition</em></a></li>
</ul>
</li><li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#higher-order-functions">Higher-order functions</a></li><li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#anonymous-functions">Anonymous functions</a></li><li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#pure-functions">Pure functions</a></li><li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#recursion">Recursion</a></li><li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#iterators">Iterators</a></li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#generators" tabindex="-1">Generators</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#generators-and-comprehensions">Generators and comprehensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#utilites-enumerate-zip-and-the-ternary-if-else-operator">Utilites - enumerate, zip and the ternary if-else operator</a></li>
</ul>
</li><li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#decorators">Decorators</a></li><li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#the-operator-module">The <code class="docutils literal"><span class="pre">operator</span></code> module</a></li><li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#the-functools-module">The <code class="docutils literal"><span class="pre">functools</span></code> module</a></li><li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#the-itertools-module">The <code class="docutils literal"><span class="pre">itertools</span></code> module</a></li><li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#the-toolz-fn-and-funcy-modules">The <code class="docutils literal"><span class="pre">toolz</span></code>, <code class="docutils literal"><span class="pre">fn</span></code> and <code class="docutils literal"><span class="pre">funcy</span></code> modules</a></li><li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#exercises">Exercises</a></li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DataProcessingSolutions.html" tabindex="-1">Data science is OSEMN</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DataProcessingSolutions.html#obtaining-data">Obtaining data</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DataProcessingSolutions.html#scrubbing-data">Scrubbing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DataProcessingSolutions.html#exercises">Exercises</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingSolutions.html" tabindex="-1">Working with text</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingSolutions.html#string-methods">String methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingSolutions.html#splitting-and-joining-strings">Splitting and joining strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingSolutions.html#the-string-module">The string module</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingSolutions.html#regular-expressions">Regular expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingSolutions.html#the-nltk-toolkit">The NLTK toolkit</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingSolutions.html#exercises">Exercises</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingExtras.html" tabindex="-1">Preprocessing text data</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingExtras.html#example-counting-words-in-a-document">Example: Counting words in a document</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WorkingWithStructuredData.html" tabindex="-1">Working with structured data</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WorkingWithStructuredData.html#using-sqlite3">Using SQLite3</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WorkingWithStructuredData.html#basic-concepts-of-database-normalization">Basic concepts of database normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WorkingWithStructuredData.html#using-hdf5">Using HDF5</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WorkingWithStructuredData.html#interfacing-withpandas">Interfacing withPandas</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html" tabindex="-1">Using numpy</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#ndarray">NDArray</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#broadcasting-row-column-and-matrix-operations">Broadcasting, row, column and matrix operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#universal-functions-ufuncs">Universal functions (Ufuncs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#generalized-ufucns">Generalized ufucns</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#random-numbers">Random numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#linear-algebra">Linear algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#exercises">Exercises</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html" tabindex="-1">Using Pandas</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#series">Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#dataframe">DataFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#panels">Panels</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#split-apply-combine">Split-Apply-Combine</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#using-statsmodels">Using statsmodels</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#using-r-from-ipython" tabindex="-1">Using R from IPython</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#using-rmagic">Using Rmagic</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#using-r-from-pandas">Using R from pandas</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputationalStatisticsMotivation.html" tabindex="-1">Computational problems in statistics</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputationalStatisticsMotivation.html#textbook-example-is-coin-fair">Textbook example - is coin fair?</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputationalStatisticsMotivation.html#bayesian-approach">Bayesian approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputationalStatisticsMotivation.html#comment">Comment</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputerArithmetic.html" tabindex="-1">Computer numbers and mathematics</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputerArithmetic.html#some-examples-of-numbers-behaving-badly">Some examples of numbers behaving badly</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputerArithmetic.html#finite-representation-of-numbers">Finite representation of numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputerArithmetic.html#using-arbitrary-precision-libraries">Using arbitrary precision libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputerArithmetic.html#from-numbers-to-functions-stability-and-conditioning">From numbers to Functions: Stability and conditioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputerArithmetic.html#exercises">Exercises</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/AlgorithmicComplexity.html" tabindex="-1">Algorithmic complexity</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/AlgorithmicComplexity.html#profling-and-benchmarking">Profling and benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/AlgorithmicComplexity.html#measuring-algorithmic-complexity">Measuring algorithmic complexity</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/AlgorithmicComplexity.html#space-complexity">Space complexity</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html" tabindex="-1">Linear Algebra and Linear Systems</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#simultaneous-equations">Simultaneous Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#linear-independence">Linear Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#norms-and-distance-of-vectors">Norms and Distance of Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#trace-and-determinant-of-matrices">Trace and Determinant of Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#column-space-row-space-rank-and-kernel">Column space, Row space, Rank and Kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#matrices-as-linear-transformations">Matrices as Linear Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#matrix-norms">Matrix Norms</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#special-matrices">Special Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#exercises">Exercises</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html" tabindex="-1">Linear Algebra and Matrix Decompositions</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html#large-linear-systems">Large Linear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html#example-netflix-competition-circa-2006-2009">Example: Netflix Competition (circa 2006-2009)</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html#matrix-decompositions">Matrix Decompositions</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html#matrix-decompositions-for-pca-and-least-squares">Matrix Decompositions for PCA and Least Squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html#singular-value-decomposition">Singular Value Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html#stabilty-and-condition-number">Stabilty and Condition Number</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html#exercises">Exercises</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html" tabindex="-1">Change of Basis</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html#variance-and-covariance">Variance and covariance</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html#eigendecomposition-of-the-covariance-matrix">Eigendecomposition of the covariance matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html#pca">PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html#change-of-basis-via-pca">Change of basis via PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html#graphical-illustration-of-change-of-basis">Graphical illustration of change of basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html#dimension-reduction-via-pca">Dimension reduction via PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html#using-singular-value-decomposition-svd-for-pca">Using Singular Value Decomposition (SVD) for PCA</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html" tabindex="-1">Optimization and Non-linear Methods</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html#example-maximum-likelihood-estimation-mle">Example: Maximum Likelihood Estimation (MLE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html#bisection-method">Bisection Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html#secant-method">Secant Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html#newton-rhapson-method">Newton-Rhapson Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html#gauss-newton">Gauss-Newton</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html#inverse-quadratic-interpolation">Inverse Quadratic Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html#brent-s-method">Brent’s Method</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html" tabindex="-1">Practical Optimizatio Routines</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#finding-roots">Finding roots</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#optimization-primer">Optimization Primer</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#using-scipy-optimize">Using <code class="docutils literal"><span class="pre">scipy.optimize</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#gradient-deescent">Gradient deescent</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#newton-s-method-and-variants">Newton’s method and variants</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#constrained-optimization">Constrained optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#curve-fitting">Curve fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#finding-paraemeters-for-ode-models">Finding paraemeters for ODE models</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#optimization-of-graph-node-placement">Optimization of graph node placement</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#optimization-of-standard-statistical-models">Optimization of standard statistical models</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CalibratingODEs.html" tabindex="-1">Fitting ODEs with the Levenberg–Marquardt algorithm</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CalibratingODEs.html#d-example">1D example</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CalibratingODEs.html#id1">2D example</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultivariateOptimizationAlgortihms.html" tabindex="-1">Algorithms for Optimization and Root Finding for Multivariate Problems</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultivariateOptimizationAlgortihms.html#optimizers">Optimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultivariateOptimizationAlgortihms.html#solvers">Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultivariateOptimizationAlgortihms.html#glm-estimation-and-irls">GLM Estimation and IRLS</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html" tabindex="-1">Expectation Maximizatio (EM) Algorithm</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#jensen-s-inequality">Jensen’s inequality</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#maximum-likelihood-with-complete-information">Maximum likelihood with complete information</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#incomplete-information">Incomplete information</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#gaussian-mixture-models">Gaussian mixture models</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#using-em">Using EM</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#vectorized-version">Vectorized version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#vectorization-with-einstein-summation-notation">Vectorization with Einstein summation notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#comparison-of-em-routines">Comparison of EM routines</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MonteCarlo.html" tabindex="-1">Monte Carlo Methods</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MonteCarlo.html#pseudorandom-number-generators-prng">Pseudorandom number generators (PRNG)</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MonteCarlo.html#monte-carlo-swindles-variance-reduction-techniques">Monte Carlo swindles (Variance reduction techniques)</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MonteCarlo.html#quasi-random-numbers">Quasi-random numbers</a></li>
</ul>
</li><li class="toctree-l1 current dropdown-submenu"><a class="current reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html" tabindex="-1">Resampling methods</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#resampling">Resampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#simulations">Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#setting-the-random-seed">Setting the random seed</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#sampling-with-and-without-replacement">Sampling with and without replacement</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#calculation-of-cook-s-distance">Calculation of Cook’s distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#permutation-resampling">Permutation resampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#design-of-simulation-experiments">Design of simulation experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#example-simulations-to-estimate-power">Example: Simulations to estimate power</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#check-with-r">Check with R</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#estimating-the-cdf">Estimating the CDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#estimating-the-pdf">Estimating the PDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#kernel-density-estimation">Kernel density estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#multivariate-kerndel-density-estimation">Multivariate kerndel density estimation</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MCMC.html" tabindex="-1">Markov Chain Monte Carlo (MCMC)</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MCMC.html#bayesian-data-analysis">Bayesian Data Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MCMC.html#metropolis-hastings-sampler">Metropolis-Hastings sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MCMC.html#gibbs-sampler">Gibbs sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MCMC.html#slice-sampler">Slice sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MCMC.html#hierarchical-models">Hierarchical models</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC2.html" tabindex="-1">Using PyMC2</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC2.html#coin-toss">Coin toss</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC2.html#estimating-mean-and-standard-deviation-of-normal-distribution">Estimating mean and standard deviation of normal distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC2.html#estimating-parameters-of-a-linear-regreession-model">Estimating parameters of a linear regreession model</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC2.html#estimating-parameters-of-a-logistic-model">Estimating parameters of a logistic model</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC2.html#using-a-hierarchcical-model">Using a hierarchcical model</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC3.html" tabindex="-1">Using PyMC3</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC3.html#coin-toss">Coin toss</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC3.html#estimating-mean-and-standard-deviation-of-normal-distribution">Estimating mean and standard deviation of normal distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC3.html#estimating-parameters-of-a-linear-regreession-model">Estimating parameters of a linear regreession model</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC3.html#estimating-parameters-of-a-logistic-model">Estimating parameters of a logistic model</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC3.html#using-a-hierarchcical-model">Using a hierarchcical model</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyStan.html" tabindex="-1">Using PyStan</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyStan.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyStan.html#simple-logistic-model">Simple Logistic model</a></li>
</ul>
</li><li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Animation.html">Animations of Metropolis, Gibbs and Slice Sampler dynamics</a></li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html" tabindex="-1">C Crash Course</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#hello-world">Hello world</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#a-tutorial-example-coding-a-fibonacci-function-in-c">A tutorial example - coding a Fibonacci function in C</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#types-in-c">Types in C</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#operators">Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#control-of-program-flow">Control of program flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#arrays-and-pointers">Arrays and pointers</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#function-pointers">Function pointers</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#using-make-to-compile-c-programs">Using make to compile C programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#exercise">Exercise</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MakingCodeFast.html" tabindex="-1">Code Optimization</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MakingCodeFast.html#profiling">Profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MakingCodeFast.html#using-better-algorihtms-and-data-structures">Using better algorihtms and data structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MakingCodeFast.html#i-o-bound-problems">I/O Bound problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MakingCodeFast.html#problem-set-for-optimization">Problem set for optimization</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCToPython.html" tabindex="-1">Using C code in Python</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCToPython.html#example-the-fibonacci-sequence">Example: The Fibonacci Sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCToPython.html#using-clang-and-bitey">Using clang and bitey</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCToPython.html#using-gcc-and-ctypes">Using gcc and ctypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCToPython.html#using-cython">Using Cython</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCToPython.html#benchmark">Benchmark</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCompiledToPython.html" tabindex="-1">Using functions from various compiled languages in Python</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCompiledToPython.html#c">C</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCompiledToPython.html#id1">C++</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCompiledToPython.html#fortran">Fortran</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCompiledToPython.html#benchmarking">Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCompiledToPython.html#wrapping-a-function-from-a-c-library-for-use-in-python">Wrapping a function from a C library for use in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCompiledToPython.html#wrapping-functions-from-c-library-for-use-in-pyton">Wrapping functions from C++ library for use in Pyton</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromJuliaToPython.html" tabindex="-1">Julia and Python</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromJuliaToPython.html#defining-a-function-in-julia">Defining a function in Julia</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromJuliaToPython.html#using-it-in-python">Using it in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromJuliaToPython.html#using-python-libraries-in-julia">Using Python libraries in Julia</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html" tabindex="-1">Converting Python Code to C for speed</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html#example-fibonacci">Example: Fibonacci</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html#example-matrix-multiplication">Example: Matrix multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html#example-pairwise-distance-matrix">Example: Pairwise distance matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html#profiling-code">Profiling code</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html#numba">Numba</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html#cython">Cython</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html#comparison-with-optimized-c-from-scipy">Comparison with optimized C from scipy</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html" tabindex="-1">Optimization bake-off</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#python-version">Python version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#numpy-version">Numpy version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#numexpr-version">Numexpr version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#numba-version">Numba version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#numbapro-version">NumbaPro version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#parakeet-version">Parakeet version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#cython-version">Cython version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#c-version">C version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#id1">C++ version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#fortran-version">Fortran version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#bake-off">Bake-off</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#recommendations-for-optimizing-python-code">Recommendations for optimizing Python code</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WritingParallelCode.html" tabindex="-1">Writing Parallel Code</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WritingParallelCode.html#concepts">Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WritingParallelCode.html#embarassingly-parallel-programs">Embarassingly parallel programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WritingParallelCode.html#using-multiprocessing">Using Multiprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WritingParallelCode.html#using-ipython-parallel-for-interactive-parallel-computing">Using IPython parallel for interactive parallel computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WritingParallelCode.html#other-parallel-programming-approaches-not-covered">Other parallel programming approaches not covered</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WritingParallelCode.html#references">References</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html" tabindex="-1">Massively parallel programming with GPUs</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#programming-gpus">Programming GPUs</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#gpu-architecture">GPU Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#cuda-python">CUDA Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#getting-started-with-cuda">Getting Started with CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#vector-addition-the-hello-world-of-cuda">Vector addition - the ‘Hello, world’ of CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#performing-a-reduction-on-cuda">Performing a reduction on CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#recreational">Recreational</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#more-examples">More examples</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/GPUsAndCUDAC.html" tabindex="-1">Writing CUDA in C</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/GPUsAndCUDAC.html#review-of-gpu-architechture-a-simplification">Review of GPU Architechture - A Simplification</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/GPUsAndCUDAC.html#cuda-c-program-an-outline">Cuda C program - an Outline</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html" tabindex="-1">Distributed computing for Big Data</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html#why-and-when-does-distributed-computing-matter">Why and when does distributed computing matter?</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html#ingredients-for-effiicient-distributed-computing">Ingredients for effiicient distributed computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html#what-is-hadoop">What is Hadoop?</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html#review-of-functional-programming">Review of functional programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html#the-hadoop-mapreduce-workflow">The Hadoop MapReduce workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html#using-hadoop-mapreduce">Using Hadoop MapReduce</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html#spark">Spark</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MapReduce.html" tabindex="-1">Hadoop MapReduce on AWS EMR with <code class="docutils literal"><span class="pre">mrjob</span></code></a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MapReduce.html#mapreduce-code">MapReduce code</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MapReduce.html#configuration-file">Configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MapReduce.html#launching-job">Launching job</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Spark.html" tabindex="-1">Spark on a local mahcine using 4 nodes</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Spark.html#using-spark-in-standalone-prograsm">Using Spark in standalone prograsm</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Spark.html#introduction-to-spark-concepts-with-a-data-manipulation-example">Introduction to Spark concepts with a data manipulation example</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Spark.html#using-the-mllib-for-regression">Using the MLlib for Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Spark.html#references">References</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ModulesAndPackaging.html" tabindex="-1">Modules and Packaging</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ModulesAndPackaging.html#modules">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ModulesAndPackaging.html#distributing-your-package">Distributing your package</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Jupyter.html" tabindex="-1">Tour of the Jupyter (IPython3) notebook</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Jupyter.html#installing-jupyter">Installing Jupyter</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Jupyter.html#installing-other-kernels">Installing other kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Jupyter.html#installing-extensions">Installing extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Jupyter.html#installing-python3-while-keeping-python2">Installing Python3 while keeping Python2</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Jupyter.html#now-restart-your-notebook-server">Now, restart your notebook server</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html" tabindex="-1">Polyglot programming</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html#python-2">Python 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html#python-3">Python 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html#bash">Bash</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html#r">R</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html#scala">Scala</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html#julia">Julia</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html#processing">Processing</a></li>
</ul>
</li><li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ReveiwAndTrends.html" tabindex="-1">What you should know and learn more about</a><ul class="unstyled dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ReveiwAndTrends.html#statistical-foundations">Statistical foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ReveiwAndTrends.html#computing-foundations">Computing foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ReveiwAndTrends.html#mathematical-foundations">Mathematical foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ReveiwAndTrends.html#statistical-algorithms">Statistical algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ReveiwAndTrends.html#libraries-worth-knowing-about-after-numpy-scipy-and-matplotlib">Libraries worth knowing about after numpy, scipy and matplotlib</a></li>
</ul>
</li>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button" id="dLabelLocalToc" data-toggle="dropdown" data-target="#" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc" role="menu" aria-labelledby="dLabelLocalToc"><li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#">Resampling methods</a>
</li><li class="divider"></li><li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#resampling">Resampling</a></li><li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#simulations">Simulations</a></li><li class="dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#setting-the-random-seed" tabindex="-1">Setting the random seed</a><ul class="unstyled dropdown-menu">
<li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#id1">Resampling</a></li>
</ul>
</li><li class="dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#sampling-with-and-without-replacement" tabindex="-1">Sampling with and without replacement</a><ul class="unstyled dropdown-menu">
<li class="dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#bootstrap" tabindex="-1">Bootstrap</a><ul class="unstyled dropdown-menu">
<li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#reprise-of-bootstrap-example-for-monte-carlo-integration">Reprise of bootstrap example for Monte Carlo integration</a></li>
</ul>
</li>
<li class="dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#leave-some-out-resampling" tabindex="-1">Leave some-out resampling</a><ul class="unstyled dropdown-menu">
<li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#jackknife-estimate-of-parameters">Jackknife estimate of parameters</a></li>
<li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#leave-one-out-cross-validation-loocv">Leave one out cross validation (LOOCV)</a></li>
</ul>
</li>
</ul>
</li><li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#calculation-of-cook-s-distance">Calculation of Cook’s distance</a></li><li class="dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#permutation-resampling" tabindex="-1">Permutation resampling</a><ul class="unstyled dropdown-menu">
<li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#monte-carlo-simulations">Monte Carlo Simulations</a></li>
</ul>
</li><li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#design-of-simulation-experiments">Design of simulation experiments</a></li><li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#example-simulations-to-estimate-power">Example: Simulations to estimate power</a></li><li class="dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#check-with-r" tabindex="-1">Check with R</a><ul class="unstyled dropdown-menu">
<li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#characterizing-monte-carlo-samples">Characterizing Monte Carlo samples</a></li>
</ul>
</li><li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#estimating-the-cdf">Estimating the CDF</a></li><li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#estimating-the-pdf">Estimating the PDF</a></li><li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#kernel-density-estimation">Kernel density estimation</a></li><li><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#multivariate-kerndel-density-estimation">Multivariate kerndel density estimation</a></li>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="https://people.duke.edu/~ccc14/sta-663/MonteCarlo.html" title="Previous Chapter: Monte Carlo Methods"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">« Monte Carlo Meth...</span>
    </a>
  </li>
  <li>
    <a href="https://people.duke.edu/~ccc14/sta-663/MCMC.html" title="Next Chapter: Markov Chain Monte Carlo (MCMC)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Markov Chain Mon... »</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="https://people.duke.edu/~ccc14/sta-663/search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search">
 </div>
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav affix" role="complementary" style=""><ul class="globaltoc nav nav-list"><ul class="current nav nav-list">
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html" tabindex="-1">Introduction to Python</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#variables">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#operators">Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#iterators">Iterators</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#conditional-statements">Conditional Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#strings-and-string-handling">Strings and String Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#lists-tuples-dictionaries">Lists, Tuples, Dictionaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#classes">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#modules">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#the-standard-library">The standard library</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#keeping-the-anaconda-distribution-up-to-date">Keeping the Anaconda distribution up-to-date</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IntroductionToPythonSolutions.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IPythonNotebookIntroduction.html" tabindex="-1">Getting started with Python and the IPython notebook</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IPythonNotebookIntroduction.html#cells">Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IPythonNotebookIntroduction.html#code-cells">Code Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IPythonNotebookIntroduction.html#magic-commands">Magic Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IPythonNotebookIntroduction.html#python-as-glue">Python as Glue</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IPythonNotebookIntroduction.html#python-r-matlab-octave">Python &lt;-&gt; R &lt;-&gt; Matlab &lt;-&gt; Octave</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/IPythonNotebookIntroduction.html#more-glue-julia-and-perl">More Glue: Julia and Perl</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html">Functions are first class objects</a></li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#function-argumnents" tabindex="-1">Function argumnents</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#call-by-object-reference">Call by “object reference”</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#binding-of-default-arguments-occurs-at-function-definition">Binding of default arguments occurs at function <em>definition</em></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#higher-order-functions">Higher-order functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#anonymous-functions">Anonymous functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#pure-functions">Pure functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#recursion">Recursion</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#iterators">Iterators</a></li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#generators" tabindex="-1">Generators</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#generators-and-comprehensions">Generators and comprehensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#utilites-enumerate-zip-and-the-ternary-if-else-operator">Utilites - enumerate, zip and the ternary if-else operator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#decorators">Decorators</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#the-operator-module">The <code class="docutils literal"><span class="pre">operator</span></code> module</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#the-functools-module">The <code class="docutils literal"><span class="pre">functools</span></code> module</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#the-itertools-module">The <code class="docutils literal"><span class="pre">itertools</span></code> module</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#the-toolz-fn-and-funcy-modules">The <code class="docutils literal"><span class="pre">toolz</span></code>, <code class="docutils literal"><span class="pre">fn</span></code> and <code class="docutils literal"><span class="pre">funcy</span></code> modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FunctionsSolutions.html#exercises">Exercises</a></li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DataProcessingSolutions.html" tabindex="-1">Data science is OSEMN</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DataProcessingSolutions.html#obtaining-data">Obtaining data</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DataProcessingSolutions.html#scrubbing-data">Scrubbing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DataProcessingSolutions.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingSolutions.html" tabindex="-1">Working with text</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingSolutions.html#string-methods">String methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingSolutions.html#splitting-and-joining-strings">Splitting and joining strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingSolutions.html#the-string-module">The string module</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingSolutions.html#regular-expressions">Regular expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingSolutions.html#the-nltk-toolkit">The NLTK toolkit</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingSolutions.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingExtras.html" tabindex="-1">Preprocessing text data</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/TextProcessingExtras.html#example-counting-words-in-a-document">Example: Counting words in a document</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WorkingWithStructuredData.html" tabindex="-1">Working with structured data</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WorkingWithStructuredData.html#using-sqlite3">Using SQLite3</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WorkingWithStructuredData.html#basic-concepts-of-database-normalization">Basic concepts of database normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WorkingWithStructuredData.html#using-hdf5">Using HDF5</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WorkingWithStructuredData.html#interfacing-withpandas">Interfacing withPandas</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html" tabindex="-1">Using numpy</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#ndarray">NDArray</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#broadcasting-row-column-and-matrix-operations">Broadcasting, row, column and matrix operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#universal-functions-ufuncs">Universal functions (Ufuncs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#generalized-ufucns">Generalized ufucns</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#random-numbers">Random numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#linear-algebra">Linear algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingNumpySolutions.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html" tabindex="-1">Using Pandas</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#series">Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#dataframe">DataFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#panels">Panels</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#split-apply-combine">Split-Apply-Combine</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#using-statsmodels">Using statsmodels</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#using-r-from-ipython" tabindex="-1">Using R from IPython</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#using-rmagic">Using Rmagic</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/UsingPandas.html#using-r-from-pandas">Using R from pandas</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputationalStatisticsMotivation.html" tabindex="-1">Computational problems in statistics</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputationalStatisticsMotivation.html#textbook-example-is-coin-fair">Textbook example - is coin fair?</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputationalStatisticsMotivation.html#bayesian-approach">Bayesian approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputationalStatisticsMotivation.html#comment">Comment</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputerArithmetic.html" tabindex="-1">Computer numbers and mathematics</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputerArithmetic.html#some-examples-of-numbers-behaving-badly">Some examples of numbers behaving badly</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputerArithmetic.html#finite-representation-of-numbers">Finite representation of numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputerArithmetic.html#using-arbitrary-precision-libraries">Using arbitrary precision libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputerArithmetic.html#from-numbers-to-functions-stability-and-conditioning">From numbers to Functions: Stability and conditioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ComputerArithmetic.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/AlgorithmicComplexity.html" tabindex="-1">Algorithmic complexity</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/AlgorithmicComplexity.html#profling-and-benchmarking">Profling and benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/AlgorithmicComplexity.html#measuring-algorithmic-complexity">Measuring algorithmic complexity</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/AlgorithmicComplexity.html#space-complexity">Space complexity</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html" tabindex="-1">Linear Algebra and Linear Systems</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#simultaneous-equations">Simultaneous Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#linear-independence">Linear Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#norms-and-distance-of-vectors">Norms and Distance of Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#trace-and-determinant-of-matrices">Trace and Determinant of Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#column-space-row-space-rank-and-kernel">Column space, Row space, Rank and Kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#matrices-as-linear-transformations">Matrices as Linear Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#matrix-norms">Matrix Norms</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#special-matrices">Special Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraReview.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html" tabindex="-1">Linear Algebra and Matrix Decompositions</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html#large-linear-systems">Large Linear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html#example-netflix-competition-circa-2006-2009">Example: Netflix Competition (circa 2006-2009)</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html#matrix-decompositions">Matrix Decompositions</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html#matrix-decompositions-for-pca-and-least-squares">Matrix Decompositions for PCA and Least Squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html#singular-value-decomposition">Singular Value Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html#stabilty-and-condition-number">Stabilty and Condition Number</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/LinearAlgebraMatrixDecompWithSolutions.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html" tabindex="-1">Change of Basis</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html#variance-and-covariance">Variance and covariance</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html#eigendecomposition-of-the-covariance-matrix">Eigendecomposition of the covariance matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html#pca">PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html#change-of-basis-via-pca">Change of basis via PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html#graphical-illustration-of-change-of-basis">Graphical illustration of change of basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html#dimension-reduction-via-pca">Dimension reduction via PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PCASolutions.html#using-singular-value-decomposition-svd-for-pca">Using Singular Value Decomposition (SVD) for PCA</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html" tabindex="-1">Optimization and Non-linear Methods</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html#example-maximum-likelihood-estimation-mle">Example: Maximum Likelihood Estimation (MLE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html#bisection-method">Bisection Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html#secant-method">Secant Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html#newton-rhapson-method">Newton-Rhapson Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html#gauss-newton">Gauss-Newton</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html#inverse-quadratic-interpolation">Inverse Quadratic Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/OptimizationInOneDimension.html#brent-s-method">Brent’s Method</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html" tabindex="-1">Practical Optimizatio Routines</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#finding-roots">Finding roots</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#optimization-primer">Optimization Primer</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#using-scipy-optimize">Using <code class="docutils literal"><span class="pre">scipy.optimize</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#gradient-deescent">Gradient deescent</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#newton-s-method-and-variants">Newton’s method and variants</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#constrained-optimization">Constrained optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#curve-fitting">Curve fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#finding-paraemeters-for-ode-models">Finding paraemeters for ODE models</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#optimization-of-graph-node-placement">Optimization of graph node placement</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/BlackBoxOptimization.html#optimization-of-standard-statistical-models">Optimization of standard statistical models</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CalibratingODEs.html" tabindex="-1">Fitting ODEs with the Levenberg–Marquardt algorithm</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CalibratingODEs.html#d-example">1D example</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CalibratingODEs.html#id1">2D example</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultivariateOptimizationAlgortihms.html" tabindex="-1">Algorithms for Optimization and Root Finding for Multivariate Problems</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultivariateOptimizationAlgortihms.html#optimizers">Optimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultivariateOptimizationAlgortihms.html#solvers">Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultivariateOptimizationAlgortihms.html#glm-estimation-and-irls">GLM Estimation and IRLS</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html" tabindex="-1">Expectation Maximizatio (EM) Algorithm</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#jensen-s-inequality">Jensen’s inequality</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#maximum-likelihood-with-complete-information">Maximum likelihood with complete information</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#incomplete-information">Incomplete information</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#gaussian-mixture-models">Gaussian mixture models</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#using-em">Using EM</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#vectorized-version">Vectorized version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#vectorization-with-einstein-summation-notation">Vectorization with Einstein summation notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/EMAlgorithm.html#comparison-of-em-routines">Comparison of EM routines</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MonteCarlo.html" tabindex="-1">Monte Carlo Methods</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MonteCarlo.html#pseudorandom-number-generators-prng">Pseudorandom number generators (PRNG)</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MonteCarlo.html#monte-carlo-swindles-variance-reduction-techniques">Monte Carlo swindles (Variance reduction techniques)</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MonteCarlo.html#quasi-random-numbers">Quasi-random numbers</a></li>
</ul>
</li>
<li class="toctree-l1 current dropdown-submenu"><a class="current reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html" tabindex="-1">Resampling methods</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#resampling">Resampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#simulations">Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#setting-the-random-seed">Setting the random seed</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#sampling-with-and-without-replacement">Sampling with and without replacement</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#calculation-of-cook-s-distance">Calculation of Cook’s distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#permutation-resampling">Permutation resampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#design-of-simulation-experiments">Design of simulation experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#example-simulations-to-estimate-power">Example: Simulations to estimate power</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#check-with-r">Check with R</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#estimating-the-cdf">Estimating the CDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#estimating-the-pdf">Estimating the PDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#kernel-density-estimation">Kernel density estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#multivariate-kerndel-density-estimation">Multivariate kerndel density estimation</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MCMC.html" tabindex="-1">Markov Chain Monte Carlo (MCMC)</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MCMC.html#bayesian-data-analysis">Bayesian Data Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MCMC.html#metropolis-hastings-sampler">Metropolis-Hastings sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MCMC.html#gibbs-sampler">Gibbs sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MCMC.html#slice-sampler">Slice sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MCMC.html#hierarchical-models">Hierarchical models</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC2.html" tabindex="-1">Using PyMC2</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC2.html#coin-toss">Coin toss</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC2.html#estimating-mean-and-standard-deviation-of-normal-distribution">Estimating mean and standard deviation of normal distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC2.html#estimating-parameters-of-a-linear-regreession-model">Estimating parameters of a linear regreession model</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC2.html#estimating-parameters-of-a-logistic-model">Estimating parameters of a logistic model</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC2.html#using-a-hierarchcical-model">Using a hierarchcical model</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC3.html" tabindex="-1">Using PyMC3</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC3.html#coin-toss">Coin toss</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC3.html#estimating-mean-and-standard-deviation-of-normal-distribution">Estimating mean and standard deviation of normal distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC3.html#estimating-parameters-of-a-linear-regreession-model">Estimating parameters of a linear regreession model</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC3.html#estimating-parameters-of-a-logistic-model">Estimating parameters of a logistic model</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyMC3.html#using-a-hierarchcical-model">Using a hierarchcical model</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyStan.html" tabindex="-1">Using PyStan</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyStan.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/PyStan.html#simple-logistic-model">Simple Logistic model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Animation.html">Animations of Metropolis, Gibbs and Slice Sampler dynamics</a></li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html" tabindex="-1">C Crash Course</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#hello-world">Hello world</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#a-tutorial-example-coding-a-fibonacci-function-in-c">A tutorial example - coding a Fibonacci function in C</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#types-in-c">Types in C</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#operators">Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#control-of-program-flow">Control of program flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#arrays-and-pointers">Arrays and pointers</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#function-pointers">Function pointers</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#using-make-to-compile-c-programs">Using make to compile C programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CrashCourseInC.html#exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MakingCodeFast.html" tabindex="-1">Code Optimization</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MakingCodeFast.html#profiling">Profiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MakingCodeFast.html#using-better-algorihtms-and-data-structures">Using better algorihtms and data structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MakingCodeFast.html#i-o-bound-problems">I/O Bound problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MakingCodeFast.html#problem-set-for-optimization">Problem set for optimization</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCToPython.html" tabindex="-1">Using C code in Python</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCToPython.html#example-the-fibonacci-sequence">Example: The Fibonacci Sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCToPython.html#using-clang-and-bitey">Using clang and bitey</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCToPython.html#using-gcc-and-ctypes">Using gcc and ctypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCToPython.html#using-cython">Using Cython</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCToPython.html#benchmark">Benchmark</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCompiledToPython.html" tabindex="-1">Using functions from various compiled languages in Python</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCompiledToPython.html#c">C</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCompiledToPython.html#id1">C++</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCompiledToPython.html#fortran">Fortran</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCompiledToPython.html#benchmarking">Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCompiledToPython.html#wrapping-a-function-from-a-c-library-for-use-in-python">Wrapping a function from a C library for use in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromCompiledToPython.html#wrapping-functions-from-c-library-for-use-in-pyton">Wrapping functions from C++ library for use in Pyton</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromJuliaToPython.html" tabindex="-1">Julia and Python</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromJuliaToPython.html#defining-a-function-in-julia">Defining a function in Julia</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromJuliaToPython.html#using-it-in-python">Using it in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromJuliaToPython.html#using-python-libraries-in-julia">Using Python libraries in Julia</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html" tabindex="-1">Converting Python Code to C for speed</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html#example-fibonacci">Example: Fibonacci</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html#example-matrix-multiplication">Example: Matrix multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html#example-pairwise-distance-matrix">Example: Pairwise distance matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html#profiling-code">Profiling code</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html#numba">Numba</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html#cython">Cython</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/FromPythonToC.html#comparison-with-optimized-c-from-scipy">Comparison with optimized C from scipy</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html" tabindex="-1">Optimization bake-off</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#python-version">Python version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#numpy-version">Numpy version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#numexpr-version">Numexpr version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#numba-version">Numba version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#numbapro-version">NumbaPro version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#parakeet-version">Parakeet version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#cython-version">Cython version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#c-version">C version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#id1">C++ version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#fortran-version">Fortran version</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#bake-off">Bake-off</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Optimization_Bakeoff.html#recommendations-for-optimizing-python-code">Recommendations for optimizing Python code</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WritingParallelCode.html" tabindex="-1">Writing Parallel Code</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WritingParallelCode.html#concepts">Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WritingParallelCode.html#embarassingly-parallel-programs">Embarassingly parallel programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WritingParallelCode.html#using-multiprocessing">Using Multiprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WritingParallelCode.html#using-ipython-parallel-for-interactive-parallel-computing">Using IPython parallel for interactive parallel computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WritingParallelCode.html#other-parallel-programming-approaches-not-covered">Other parallel programming approaches not covered</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/WritingParallelCode.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html" tabindex="-1">Massively parallel programming with GPUs</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#programming-gpus">Programming GPUs</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#gpu-architecture">GPU Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#cuda-python">CUDA Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#getting-started-with-cuda">Getting Started with CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#vector-addition-the-hello-world-of-cuda">Vector addition - the ‘Hello, world’ of CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#performing-a-reduction-on-cuda">Performing a reduction on CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#recreational">Recreational</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/CUDAPython.html#more-examples">More examples</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/GPUsAndCUDAC.html" tabindex="-1">Writing CUDA in C</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/GPUsAndCUDAC.html#review-of-gpu-architechture-a-simplification">Review of GPU Architechture - A Simplification</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/GPUsAndCUDAC.html#cuda-c-program-an-outline">Cuda C program - an Outline</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html" tabindex="-1">Distributed computing for Big Data</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html#why-and-when-does-distributed-computing-matter">Why and when does distributed computing matter?</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html#ingredients-for-effiicient-distributed-computing">Ingredients for effiicient distributed computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html#what-is-hadoop">What is Hadoop?</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html#review-of-functional-programming">Review of functional programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html#the-hadoop-mapreduce-workflow">The Hadoop MapReduce workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html#using-hadoop-mapreduce">Using Hadoop MapReduce</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/DistributedComputing.html#spark">Spark</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MapReduce.html" tabindex="-1">Hadoop MapReduce on AWS EMR with <code class="docutils literal"><span class="pre">mrjob</span></code></a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MapReduce.html#mapreduce-code">MapReduce code</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MapReduce.html#configuration-file">Configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MapReduce.html#launching-job">Launching job</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Spark.html" tabindex="-1">Spark on a local mahcine using 4 nodes</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Spark.html#using-spark-in-standalone-prograsm">Using Spark in standalone prograsm</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Spark.html#introduction-to-spark-concepts-with-a-data-manipulation-example">Introduction to Spark concepts with a data manipulation example</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Spark.html#using-the-mllib-for-regression">Using the MLlib for Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Spark.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ModulesAndPackaging.html" tabindex="-1">Modules and Packaging</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ModulesAndPackaging.html#modules">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ModulesAndPackaging.html#distributing-your-package">Distributing your package</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Jupyter.html" tabindex="-1">Tour of the Jupyter (IPython3) notebook</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Jupyter.html#installing-jupyter">Installing Jupyter</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Jupyter.html#installing-other-kernels">Installing other kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Jupyter.html#installing-extensions">Installing extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Jupyter.html#installing-python3-while-keeping-python2">Installing Python3 while keeping Python2</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/Jupyter.html#now-restart-your-notebook-server">Now, restart your notebook server</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html" tabindex="-1">Polyglot programming</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html#python-2">Python 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html#python-3">Python 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html#bash">Bash</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html#r">R</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html#scala">Scala</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html#julia">Julia</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/MultiKernel.html#processing">Processing</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown-submenu"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ReveiwAndTrends.html" tabindex="-1">What you should know and learn more about</a><ul class="dropdown-menu nav nav-list">
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ReveiwAndTrends.html#statistical-foundations">Statistical foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ReveiwAndTrends.html#computing-foundations">Computing foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ReveiwAndTrends.html#mathematical-foundations">Mathematical foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ReveiwAndTrends.html#statistical-algorithms">Statistical algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="https://people.duke.edu/~ccc14/sta-663/ReveiwAndTrends.html#libraries-worth-knowing-about-after-numpy-scipy-and-matplotlib">Libraries worth knowing about after numpy, scipy and matplotlib</a></li>
</ul>
</li>
</ul>
</ul>
<form action="https://people.duke.edu/~ccc14/sta-663/search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search">
 </div>
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
        </div>
      </div>
    <div class="col-md-9">
      
  <div class="code python highlight-python"><div class="highlight"><pre>from __future__ import division
import os
import sys
import glob
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
%matplotlib inline
%precision 4
plt.style.use('ggplot')
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">formatter</span><span class="o">=</span><span class="p">{</span><span class="s">'float'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">'</span><span class="si">%.3f</span><span class="s">'</span> <span class="o">%</span> <span class="n">x</span><span class="p">})</span>
</pre></div>
</div>
<div class="section" id="resampling-methods">
<h1>Resampling methods<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#resampling-methods" title="Permalink to this headline">¶</a></h1>
<div class="section" id="resampling">
<h2>Resampling<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#resampling" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Sampling with and without replacement</li>
<li>Bootstrap (using sampling with replacement)</li>
<li>Jackknife (using subsets)</li>
<li>Cross validation and LOOCV (using subsets)</li>
<li>Permutation resampling (switching labels)</li>
</ul>
</div>
<div class="section" id="simulations">
<h2>Simulations<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#simulations" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Design of experiments</li>
<li>Power from simulations</li>
<li>Hypothesis testing from simulations</li>
<li>Empirical CDF</li>
<li>Density estimation</li>
</ul>
</div>
<div class="section" id="setting-the-random-seed">
<h2>Setting the random seed<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#setting-the-random-seed" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id1">
<h3>Resampling<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#id1" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="sampling-with-and-without-replacement">
<h2>Sampling with and without replacement<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#sampling-with-and-without-replacement" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Sampling is done with replacement by default</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Probability weights can be given</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">4</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">x</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># sampling individual elements</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># sampling rows</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># sampling columns</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">x</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Give the argument replace=False</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">e</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Cannot take a larger sample than population when 'replace=False'
</pre></div>
</div>
<p>You will likely have used this for the stochastic gradient descent
homework.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">x</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Shuffling occurs "in place" for efficiency</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># To shuffle columns instead, transpose before shuffling</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># numpy.random.permutation does the same thing but returns a copy</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># When given an integre n, permutation treats is as the array arange(n)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Use indices if you needed to shuffle collections of arrays in synchrony</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">10</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">print</span> <span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:],</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span>
<span class="k">print</span> <span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>[[ 9 10 11]
 [ 3  4  5]
 [ 6  7  8]
 [ 0  1  2]]

[[19 20 21]
 [13 14 15]
 [16 17 18]
 [10 11 12]]
</pre></div>
</div>
<div class="section" id="bootstrap">
<h3>Bootstrap<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#bootstrap" title="Permalink to this headline">¶</a></h3>
<p>The bootstrap is commonly used to estimate statistics when theory fails.
We have already seen the bootstrap for estiamting confidence bounds for
convergence in the Monte Carlo integration.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># For example, what is the 95% confidence interval for</span>
<span class="c"># the mean of this data set if you didn't know how it was generated?</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s">'step'</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_24_0.png" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/ResamplingAndMonteCarloSimulations_24_0.png">
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">reps</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">xb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">reps</span><span class="p">))</span>
<span class="n">mb</span> <span class="o">=</span> <span class="n">xb</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mb</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">mb</span><span class="p">,</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([</span><span class="mf">0.483</span><span class="p">,</span> <span class="mf">0.740</span><span class="p">])</span>
</pre></div>
</div>
<div class="section" id="reprise-of-bootstrap-example-for-monte-carlo-integration">
<h4>Reprise of bootstrap example for Monte Carlo integration<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#reprise-of-bootstrap-example-for-monte-carlo-integration" title="Permalink to this headline">¶</a></h4>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">71</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">13</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># data sample for integration</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># bootstrap MC integration</span>
<span class="n">reps</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">xb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">reps</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">yb</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)[:,</span> <span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">upper</span><span class="p">,</span> <span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">yb</span><span class="p">,</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)[:,</span> <span class="bp">None</span><span class="p">],</span> <span class="n">yb</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'grey'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">yb</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s">'red'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">upper</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">lower</span><span class="p">,</span> <span class="s">'b'</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_30_0.png" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/ResamplingAndMonteCarloSimulations_30_0.png">
</div>
</div>
<div class="section" id="leave-some-out-resampling">
<h3>Leave some-out resampling<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#leave-some-out-resampling" title="Permalink to this headline">¶</a></h3>
<div class="section" id="jackknife-estimate-of-parameters">
<h4>Jackknife estimate of parameters<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#jackknife-estimate-of-parameters" title="Permalink to this headline">¶</a></h4>
<p>This shows the leave-one-out calculation idiom for Python. Unlike R, a
-k index to an array does not delete the kth entry, but returns the kth
entry from the end, so we need another way to efficiently drop one
scalar or vector. This can be done using Boolean indexing as shown in
the examples below, and is efficient since the operations are on <em>views</em>
of the origianl array rather thna <em>copies</em>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">jackknife</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
    <span class="sd">"""Jackknife estimate of the estimator func"""</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="o">!=</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Jackknife estimate of standard deviation</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">jackknife</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">1.9223</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">jackknife_var</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
    <span class="sd">"""Jackknife estiamte of the variance of the estimator func."""</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">j_est</span> <span class="o">=</span> <span class="n">jackknife</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="o">!=</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">j_est</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span>
                                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># estimate of the variance of an estimator</span>
<span class="n">jackknife_var</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">0.0254</span>
</pre></div>
</div>
</div>
<div class="section" id="leave-one-out-cross-validation-loocv">
<h4>Leave one out cross validation (LOOCV)<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#leave-one-out-cross-validation-loocv" title="Permalink to this headline">¶</a></h4>
<p>LOOCV also uses the same idiom, and a simple example of LOOCV for model
selection is illustrated.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">deg</span><span class="p">)</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">'r:o'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s">'b-'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Degree = </span><span class="si">%d</span><span class="s">'</span> <span class="o">%</span> <span class="n">deg</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_39_0.png" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/ResamplingAndMonteCarloSimulations_39_0.png">
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">loocv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fit</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">deg</span><span class="p">):</span>
    <span class="sd">"""LOOCV RSS for fitting a polynomial model."""</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">rss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([(</span><span class="n">y</span> <span class="o">-</span> <span class="n">pred</span><span class="p">(</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="o">!=</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="o">!=</span><span class="n">i</span><span class="p">],</span> <span class="n">deg</span><span class="p">),</span> <span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="mf">2.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">rss</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># RSS does not detect overfitting and selects the most complex model</span>
<span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">'Degree = </span><span class="si">%d</span><span class="s">, RSS=</span><span class="si">%.2f</span><span class="s">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">deg</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="p">),</span> <span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="mf">2.0</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Degree</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">59.90</span>
<span class="n">Degree</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">6.20</span>
<span class="n">Degree</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">6.20</span>
<span class="n">Degree</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">6.20</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># LOOCV selects the correct model</span>
<span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">'Degree = </span><span class="si">%d</span><span class="s">, RSS=</span><span class="si">%.2f</span><span class="s">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">deg</span><span class="p">,</span> <span class="n">loocv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">,</span> <span class="n">deg</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Degree</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">628.41</span>
<span class="n">Degree</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">64.35</span>
<span class="n">Degree</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">67.81</span>
<span class="n">Degree</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">RSS</span><span class="o">=</span><span class="mf">85.39</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="calculation-of-cook-s-distance">
<h2>Calculation of Cook’s distance<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#calculation-of-cook-s-distance" title="Permalink to this headline">¶</a></h2>
<p>Cook’s distance is used to estimate the influence of a data point when
performing least squares regression analysis. It is one of the standard
plots for linear regression in R and provides another example of the
applicationof leave-one-out resampling.</p>
<div class="math">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;MSE&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 10.532em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.462em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.51em, 1009.46em, 3.606em, -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px;"><span style="position: absolute; clip: rect(3.156em, 1000.68em, 4.169em, -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-4" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.735em;"><span class="mi" id="MathJax-Span-5" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-6" style="font-family: STIXGeneral-Regular; padding-left: 0.341em;">=</span><span class="mfrac" id="MathJax-Span-7" style="padding-left: 0.341em;"><span style="display: inline-block; position: relative; width: 6.872em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(2.874em, 1006.76em, 4.62em, -999.997em); top: -4.896em; left: 50%; margin-left: -3.376em;"><span class="mrow" id="MathJax-Span-8"><span class="munderover" id="MathJax-Span-9"><span style="display: inline-block; position: relative; width: 2.03em; height: 0px;"><span style="position: absolute; clip: rect(3.043em, 1000.85em, 4.451em, -999.997em); top: -3.995em; left: 0em;"><span class="mo" id="MathJax-Span-10" style="font-family: STIXGeneral-Regular; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.494em, 1000.45em, 4.169em, -999.997em); top: -4.502em; left: 0.904em;"><span class="mi" id="MathJax-Span-11" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.381em, 1001.13em, 4.338em, -999.997em); top: -3.713em; left: 0.904em;"><span class="texatom" id="MathJax-Span-12"><span class="mrow" id="MathJax-Span-13"><span class="mi" id="MathJax-Span-14" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-15" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-16" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-17" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-18"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(2.874em, 1000.62em, 4.169em, -999.997em); top: -3.995em; left: 0em;"><span class="texatom" id="MathJax-Span-19"><span class="mrow" id="MathJax-Span-20"><span class="munderover" id="MathJax-Span-21"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.156em, 1000.62em, 4.169em, -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-22" style="font-family: STIXGeneral-Italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.276em; left: 0.228em;"><span style="height: 0em; vertical-align: 0em; width: 0.397em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-23" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.222em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.622em;"><span class="mi" id="MathJax-Span-24" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-25" style="font-family: STIXGeneral-Regular; padding-left: 0.228em;">−</span><span class="msubsup" id="MathJax-Span-26" style="padding-left: 0.228em;"><span style="display: inline-block; position: relative; width: 1.579em; height: 0px;"><span style="position: absolute; clip: rect(2.874em, 1000.62em, 4.169em, -999.997em); top: -3.995em; left: 0em;"><span class="texatom" id="MathJax-Span-27"><span class="mrow" id="MathJax-Span-28"><span class="munderover" id="MathJax-Span-29"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.156em, 1000.62em, 4.169em, -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-30" style="font-family: STIXGeneral-Italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.276em; left: 0.228em;"><span style="height: 0em; vertical-align: 0em; width: 0.397em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-31" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.222em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.622em;"><span class="texatom" id="MathJax-Span-32"><span class="mrow" id="MathJax-Span-33"><span class="mi" id="MathJax-Span-34" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-35" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-36" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-37" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-38"><span style="display: inline-block; position: relative; width: 0.791em; height: 0px;"><span style="position: absolute; clip: rect(3.156em, 1000.28em, 4.338em, -999.997em); top: -3.995em; left: 0em;"><span class="mo" id="MathJax-Span-39" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.333em; left: 0.341em;"><span class="mn" id="MathJax-Span-40" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em, 1002.82em, 4.395em, -999.997em); top: -3.319em; left: 50%; margin-left: -1.405em;"><span class="mrow" id="MathJax-Span-41"><span class="mi" id="MathJax-Span-42" style="font-family: STIXGeneral-Italic;">p</span><span class="mtext" id="MathJax-Span-43" style="font-family: STIXGeneral-Regular;">&nbsp;</span><span class="mtext" id="MathJax-Span-44" style="font-family: STIXGeneral-Regular;">MSE</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em, 1006.87em, 1.242em, -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 6.872em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 3.191em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>D</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>Y</mi><mo stretchy="false">^</mo></mover></mrow><mi>j</mi></msub><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>Y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mi>p</mi><mtext>&nbsp;</mtext><mtext>MSE</mtext></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">D_i = \frac{\sum_{j=1}^n (\hat Y_j - \hat Y_{j(i)})^2}{p\  \text{MSE}}</script></div>
<p>The calculation of Cook’s distance involves the fitting of <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-45" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.51em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.917em, 1000.51em, 2.706em, -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-46"><span class="mi" id="MathJax-Span-47" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">n</script></span>
regression models, so we want to do this as efficiently as possible.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">cook_dist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="sd">"""Vectorized version of Cook's distance."""</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">fitted</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="n">yhat</span> <span class="o">=</span> <span class="n">fitted</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fitted</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">yhat</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">mse</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">yhat</span> <span class="o">-</span> <span class="n">model</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="o">!=</span><span class="n">i</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">idx</span><span class="o">!=</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span><span class="o">/</span><span class="n">denom</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="kn">as</span> <span class="nn">sm</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># create data set with outliers</span>
<span class="n">nobs</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">nobs</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">beta</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">]</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">nobs</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span> <span class="o">+</span> <span class="n">e</span>
<span class="n">y</span><span class="p">[[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">78</span><span class="p">]]</span> <span class="o">*=</span> <span class="mi">3</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># use Cook's distance to identify outliers</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">cook_dist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">d</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_48_0.png" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/ResamplingAndMonteCarloSimulations_48_0.png">
</div>
<div class="section" id="permutation-resampling">
<h2>Permutation resampling<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#permutation-resampling" title="Permalink to this headline">¶</a></h2>
<p>Permuatation resampling is used ot generate the null distribtuion of
labeled data by switching lebals. Because the number of permuations
grows so fast, it is typically only feasible to use a Monte Carlo sample
of the possible set of permuations in computation.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Growth of the factorial function (number of permutations) using Stirling's approximation</span>

<span class="k">def</span> <span class="nf">stirling</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">"""Stirling's approximation to the factorial."""</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="p">)</span><span class="o">**</span><span class="n">n</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="nb">zip</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">stirling</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.9221</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.9190</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">5.8362</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">23.5062</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">118.0192</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">710.0782</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mf">4980.3958</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">39902.3955</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mf">359536.8728</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">3598695.6187</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mf">39615625.0506</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">475687486.4728</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mf">6187239475.1927</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mf">86661001740.5988</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mf">1300430722199.4680</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mf">20814114415223.1367</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mf">353948328666101.1250</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mf">6372804626194313.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mf">121112786592294192.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mf">2422786846761135104.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mf">50888617325509746688.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mf">1119751494628237770752.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mf">25758525370529310834688.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mf">618297927022794799841280.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mf">15459594834691181359661056.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">26</span><span class="p">,</span> <span class="mf">402000993060955330726330368.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">27</span><span class="p">,</span> <span class="mf">10855315170319531497075245056.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mf">303982326243341862218743414784.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">29</span><span class="p">,</span> <span class="mf">8816392105377489957715009601536.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">264517095922965156800687262138368.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mf">8200764697241122458512884083195904.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mf">262446514081933026899914856968749056.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mf">8661418381417958431306228879169945600.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">34</span><span class="p">,</span> <span class="mf">294510096099824346859521185203942850560.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mf">10308575166584033336103974733365808988160.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mf">371133249087415837775601850534254065221632.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">37</span><span class="p">,</span> <span class="mf">13732789283357647537712986585599118967570432.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mf">521876921190057472102855717030406837275459584.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">39</span><span class="p">,</span> <span class="mf">20354344348300692639357061611803222912972881920.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mf">814217264494623640116433847565750863601126604800.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="mf">33384604069916415591100983328410827967169870954496.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mf">1402221223524367565643573793611811471275760323395584.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="mf">60298294706657120904833322706173396147148627061506048.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">44</span><span class="p">,</span> <span class="mf">2653241820650555398466033792063490393009887673090834432.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mf">119400906860443613913174999733586801766394224950600794112.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">46</span><span class="p">,</span> <span class="mf">5492662822140225801570025546069546965027287393900087476224.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">47</span><span class="p">,</span> <span class="mf">258165102848257451938594016029422319832480942931582618959872.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mf">12392382664425307299255962057935500269489259106719931528380416.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">49</span><span class="p">,</span> <span class="mf">607248264576510288229888440783681300390904221083157786483752960.0000</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mf">30363445939381680077841740787498028998394965264769813642857152512.0000</span><span class="p">)]</span>
</pre></div>
</div>
<p>Suppose you have 2 data sets from unknown distribution and you want to
test if some arbitrary statistic (e.g 7th percentile) is the same in the
2 data sets - what can you do?</p>
<p>An appropirate test statistic is the difference between the 7th
percentile, and if we knew the null distribution of this statisic, we
could test for the null hypothesis that the statistic = 0. Permuting the
labels of the 2 data sets allows us to create the empirical null
distribution.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">250</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="n">reps</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
<span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">n2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">)])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">xp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">ps</span><span class="p">[:,</span> <span class="p">:</span><span class="n">n1</span><span class="p">]]</span>
<span class="n">yp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">ps</span><span class="p">[:,</span> <span class="n">n1</span><span class="p">:]]</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">yp</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s">'step'</span><span class="p">)</span>
<span class="n">test_stat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">test_stat</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">)</span>
<span class="k">print</span> <span class="s">"p-value ="</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">samples</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">test_stat</span><span class="p">))</span><span class="o">/</span><span class="n">reps</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="mf">0.0124</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_55_1.png" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/ResamplingAndMonteCarloSimulations_55_1.png">
<p>We will make up some data - a tpical example is trying to identify genes
that are differentially expressed in two groups of people, pehraps those
who are helathy and those who are sick. For each gene, we can perform a
t-test to see if the gene is differnetially expressed across the two
groups at some nominal significanc level, typically 0.05. When we have
many genes, this is unsatisfactory since 5% of the genes will be found
to be differentially expressed just by chance.</p>
<p>One possible solution is to use the family-wise error rate instead -
most simply using the Bonferroni adjusted p-value. An alternative is to
use the non-parmaetric method originally proposed by Young and Westfall
that uses permuation resampling to estimate the adjusted p-value without
the assumptions of independence that the Bonferroni method makes.</p>
<p>See <a class="reference external" href="http://www3.stat.sinica.edu.tw/statistica/oldpdf/A12n16.pdf">http://www3.stat.sinica.edu.tw/statistica/oldpdf/A12n16.pdf</a> for an
overview of statistical procedures in the context of gene expressiona
array analysis, including descriptions of the p-value ajdustements shown
here.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span>

<span class="n">ngenes</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ncases</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">nctrls</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">nsamples</span> <span class="o">=</span> <span class="n">ncases</span> <span class="o">+</span> <span class="n">nctrls</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">ngenes</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="kn">as</span> <span class="nn">st</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">t</span><span class="p">,</span> <span class="n">p0</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:</span><span class="n">ncases</span><span class="p">],</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">ncases</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">p0</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
<span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">idx</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p0</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0119</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.0368</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mf">0.0117</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mf">0.0144</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">39</span><span class="p">,</span> <span class="mf">0.0247</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">44</span><span class="p">,</span> <span class="mf">0.0051</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">68</span><span class="p">,</span> <span class="mf">0.0253</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">97</span><span class="p">,</span> <span class="mf">0.0366</span><span class="p">)]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">vmin</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:</span><span class="n">ncases</span><span class="p">],</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">'nearest'</span><span class="p">,</span>
           <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'jet'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Controls'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">ncases</span><span class="p">:],</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">'nearest'</span><span class="p">,</span>
           <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'jet'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Cases'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_62_0.png" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/ResamplingAndMonteCarloSimulations_62_0.png">
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">ngenes</span> <span class="o">*</span> <span class="n">p0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
<span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">idx</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[]</span>
</pre></div>
</div>
<p>The basic idea of resampling based p-value adjustemnt is quite simple to
understand. Suppose we want to know the ajdusted p-value for the lowest
observed p-value.</p>
<p>Repeat B times</p>
<ul class="simple">
<li>Permutate the case control labels</li>
<li>Calcuate the lowest p-value for the permutted data</li>
</ul>
<p>The adjusted p-value is simply the number of permutation samples in
which the lowest permuted p-value is smaller than the observed lowest
p-value, divided by the number of permutations.</p>
<p>The next lowest adjusted p-value is more complicated, since we need to
maintain the ordering (i.e the second adjusted p-value must be larger
than the smallest adjusted p-value), and one of several related
algorithms developed by Young and Westfall is usually used. We will not
cover this in this class as the goal is to understand how permuation
resampling works rather than the complexiities of correcting for
multiple testing, but an implementation is provided for those
interested.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Let's see if the smallest adjusted p-value is significant</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">p0s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">p0</span><span class="p">))</span>
<span class="k">print</span> <span class="s">"Gene</span><span class="se">\t</span><span class="s">Unadjusted p"</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">p0</span><span class="p">)[</span><span class="n">k</span><span class="p">],</span> <span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">,</span> <span class="n">p0s</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Gene        Unadjusted p
44  0.00509946274404
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Do many permutations</span>
<span class="n">nperms</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nperms</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nperms</span><span class="p">):</span>
    <span class="n">sidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">nsamples</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">sidx</span><span class="p">]</span>
    <span class="n">pvals</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="p">:</span><span class="n">ncases</span><span class="p">],</span> <span class="n">y</span><span class="p">[:,</span> <span class="n">ncases</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">pvals</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">ps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pvals</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

<span class="k">print</span> <span class="s">"Gene</span><span class="se">\t</span><span class="s">Unadjusted p</span><span class="se">\t\t</span><span class="s">Adjusted p"</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">p0</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">,</span> <span class="n">p0s</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ps</span> <span class="o">&lt;</span> <span class="n">p0s</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="n">nperms</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Gene        Unadjusted p            Adjusted p
0   0.00509946274404        0.4016
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># This is the maxT step-down method</span>
<span class="c"># Assumes that the distribution of T-statistics is the same for all genes</span>

<span class="n">nperms</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">ngenes</span>

<span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nperms</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
<span class="n">ranks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nperms</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">sidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">nsamples</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">sidx</span><span class="p">]</span>
    <span class="n">tb</span><span class="p">,</span> <span class="n">pb</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="p">:</span><span class="n">ncases</span><span class="p">],</span> <span class="n">y</span><span class="p">[:,</span> <span class="n">ncases</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">u</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tb</span><span class="p">[</span><span class="n">ranks</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tb</span><span class="p">[</span><span class="n">ranks</span><span class="p">[</span><span class="n">j</span><span class="p">]]))</span>
    <span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">ranks</span><span class="p">]))</span>

<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">nperms</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">p2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">p2</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
<span class="nb">zip</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">p2</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">p0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">'No correction'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">p1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">'Bonferroni'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">p2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">'Westfall-Young'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">'best'</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_70_0.png" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/ResamplingAndMonteCarloSimulations_70_0.png">
<p>The Bonferrroni assumes that tests are independent. However, often test
resutls are strongly correlated (e.g. genes in the same pathway behave
similalry) and the Bonferroni will be too conservative. However the
permuation-resampling method still works in the presence of
correaltions.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span>

<span class="n">ngenes</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ncases</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">nctrls</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">nsamples</span> <span class="o">=</span> <span class="n">ncases</span> <span class="o">+</span> <span class="n">nctrls</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">)),</span> <span class="n">ngenes</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># In this extreme case, we measure the same gene 100 times</span>
<span class="n">x</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span><span class="mf">0.519</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.269</span><span class="p">,</span> <span class="mf">0.240</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.804</span><span class="p">,</span> <span class="mf">0.017</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.519</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.269</span><span class="p">,</span> <span class="mf">0.240</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.804</span><span class="p">,</span> <span class="mf">0.017</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.519</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.269</span><span class="p">,</span> <span class="mf">0.240</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.804</span><span class="p">,</span> <span class="mf">0.017</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.519</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.269</span><span class="p">,</span> <span class="mf">0.240</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.804</span><span class="p">,</span> <span class="mf">0.017</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.519</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.269</span><span class="p">,</span> <span class="mf">0.240</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.804</span><span class="p">,</span> <span class="mf">0.017</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">t</span><span class="p">,</span> <span class="n">p0</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:</span><span class="n">ncases</span><span class="p">],</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">ncases</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">p0</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
<span class="k">print</span> <span class="s">'Minimum p-value'</span><span class="p">,</span> <span class="n">p0</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="s">'# significant'</span><span class="p">,</span> <span class="n">idx</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Minimum p-value 0.0119317780363 # significant 100
</pre></div>
</div>
<p>Bonferroni tells us none of the adjusted p-values are significant, which
we know is the wrong answer.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span> <span class="o">*</span> <span class="n">p0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
<span class="k">print</span> <span class="s">'Minimum p-value'</span><span class="p">,</span> <span class="n">p1</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="s">'# significant'</span><span class="p">,</span> <span class="n">idx</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Minimum p-value 1.0 # significant 0
</pre></div>
</div>
<p>This tells us that every gene is significant, which is the correct
answer.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">nperms</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nperms</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
<span class="n">ranks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nperms</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">sidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">nsamples</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">sidx</span><span class="p">]</span>
    <span class="n">tb</span><span class="p">,</span> <span class="n">pb</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="p">:</span><span class="n">ncases</span><span class="p">],</span> <span class="n">y</span><span class="p">[:,</span> <span class="n">ncases</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">u</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tb</span><span class="p">[</span><span class="n">ranks</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tb</span><span class="p">[</span><span class="n">ranks</span><span class="p">[</span><span class="n">j</span><span class="p">]]))</span>
    <span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">ranks</span><span class="p">]))</span>

<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">nperms</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">p2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">p2</span> <span class="o">&lt;</span> <span class="mf">0.05</span>

<span class="k">print</span> <span class="s">'Minimum p-value'</span><span class="p">,</span> <span class="n">p2</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="s">'# significant'</span><span class="p">,</span> <span class="n">idx</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Minimum p-value 0.0118 # significant 100
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">p1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">'Bonferroni'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">p2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">'Westfall-Young'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">'best'</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_80_0.png" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/ResamplingAndMonteCarloSimulations_80_0.png">
<div class="section" id="monte-carlo-simulations">
<h3>Monte Carlo Simulations<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#monte-carlo-simulations" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="design-of-simulation-experiments">
<h2>Design of simulation experiments<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#design-of-simulation-experiments" title="Permalink to this headline">¶</a></h2>
<p>Some experimental design routines (e.g. factorial, latin hypercube
samplign) are proived in
<a class="reference external" href="http://pythonhosted.org//pyDOE/index.html">PyDOE</a></p>
<p>From
<a class="reference external" href="http://www4.stat.ncsu.edu/~davidian/st810a/simulation_handout.pdf">notes</a>
by Marie Dravidian</p>
<p>A Monte Carlo simulation is just like any other experiment</p>
<ul class="simple">
<li>Careful planning is required</li>
<li>Factors that are of interest to vary in the experiment: sample size
n, distribution of the data, magnitude of variation, . . .</li>
<li>Each combination of factors is a separate simulation, so that many
factors can lead to very large number of combinations and thus number
of simulations may be time consuming</li>
<li>Can use experimental design principles</li>
<li>Results must be recorded and saved in a systematic, sensible way</li>
<li>Don’t only choose factors favorable to a method you have developed!</li>
<li>Sample size S (number of data sets) must deliver acceptable precision</li>
</ul>
</div>
<div class="section" id="example-simulations-to-estimate-power">
<h2>Example: Simulations to estimate power<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#example-simulations-to-estimate-power" title="Permalink to this headline">¶</a></h2>
<p>What sample size is needed for the t-test to have a power of 0.8 with an
effect size of 0.5?</p>
<p>This is a toy example, since you can just use a pakcage to calculate it,
but the simulation approach works for <em>everything</em>, including
arbitrarily complex experimental designs, correcting for multiple
comparisons and so on(assuming infinite computational resources and you
have some prior knowledge of the likely distribution of simulation
parameters).</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Run nresps simulations</span>
<span class="c"># The power is simply the fraction of reps where</span>
<span class="c"># the p-value is less than 0.05</span>

<span class="n">nreps</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">power</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">power</span> <span class="o">&lt;</span> <span class="mf">0.8</span><span class="p">:</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">n</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">nreps</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">n2</span><span class="p">,</span> <span class="n">nreps</span><span class="p">))</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">power</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">nreps</span>
    <span class="k">print</span> <span class="n">n</span><span class="p">,</span> <span class="n">power</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>50 0.7002
51 0.706
52 0.7119
53 0.7181
54 0.7344
55 0.7351
56 0.7405
57 0.7583
58 0.761
59 0.7647
60 0.775
61 0.7878
62 0.7865
63 0.7913
64 0.8004
</pre></div>
</div>
</div>
<div class="section" id="check-with-r">
<h2>Check with R<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#check-with-r" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre>%load_ext rpy2.ipython
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre>%%R
install.packages("pwr", repos ="http://cran.us.r-project.org")
library(pwr)

power.t.test(sig.level=0.05, power=0.8, delta = 0.5)
</pre></div>
</div>
<pre class="literal-block">trying URL '<a class="reference external" href="http://cran.us.r-project.org/bin/macosx/mavericks/contrib/3.1/pwr_1.1-2.tgz">http://cran.us.r-project.org/bin/macosx/mavericks/contrib/3.1/pwr_1.1-2.tgz</a>'
Content type 'application/x-gzip' length 53156 bytes (51 Kb)
opened URL
==================================================
downloaded 51 Kb


The downloaded binary packages are in
    /var/folders/xf/rzdg30ps11g93j3w0h589q780000gn/T//RtmpWSpKKL/downloaded_packages

     Two-sample t test power calculation

              n = 63.76576
          delta = 0.5
             sd = 1
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number in <em>each</em> group
</pre>
<div class="section" id="characterizing-monte-carlo-samples">
<h3>Characterizing Monte Carlo samples<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#characterizing-monte-carlo-samples" title="Permalink to this headline">¶</a></h3>
<p>Given a bunch of random numbers from a simulaiton experiment, one of the
first steps is to visualize the CDF and PDF.</p>
</div>
</div>
<div class="section" id="estimating-the-cdf">
<h2>Estimating the CDF<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#estimating-the-cdf" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Make up some random data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Roll our own ECDF function</span>

<span class="k">def</span> <span class="nf">ecdf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">"""Return empirical CDF of x."""</span>

    <span class="n">sx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sx</span><span class="p">)))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">sx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sx</span><span class="p">,</span> <span class="n">cdf</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">sx</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ecdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_93_0.png" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/ResamplingAndMonteCarloSimulations_93_0.png">
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">statsmodels.distributions.empirical_distribution</span> <span class="kn">import</span> <span class="n">ECDF</span>

<span class="n">ecdf</span> <span class="o">=</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ecdf</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ecdf</span><span class="o">.</span><span class="n">y</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_95_0.png" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/ResamplingAndMonteCarloSimulations_95_0.png">
</div>
<div class="section" id="estimating-the-pdf">
<h2>Estimating the PDF<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#estimating-the-pdf" title="Permalink to this headline">¶</a></h2>
<p>The simplest is to plot a normalized histogram as shown above, but we
will also look at how to estimate density functions using kernel density
estimation.</p>
</div>
<div class="section" id="kernel-density-estimation">
<h2>Kernel density estimation<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#kernel-density-estimation" title="Permalink to this headline">¶</a></h2>
<p>Kernel density estimation is a form of convolution, usually with a
symmetric kenrel (e.g. a Gaussian). The degree of smoothing is
determined by a bandwidth parameter.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">epanechnikov</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="sd">"""Epanechnikov kernel."""</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">u</span><span class="o">*</span><span class="n">u</span><span class="o">/</span><span class="mf">5.0</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">silverman</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">"""Find bandwidth using heuristic suggested by Silverman</span>
<span class="sd">    .9 min(standard deviation, interquartile range/1.34)n-1/5</span>
<span class="sd">    """</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">iqr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="mi">75</span><span class="p">,</span> <span class="mi">25</span><span class="p">]))</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">y</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">iqr</span><span class="o">/</span><span class="mf">1.34</span><span class="p">])</span><span class="o">*</span><span class="n">n</span><span class="o">**-</span><span class="mf">0.2</span>
    <span class="k">return</span> <span class="n">h</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">kde</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="n">silverman</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="n">epanechnikov</span><span class="p">):</span>
    <span class="sd">"""Returns kernel density estimate.</span>
<span class="sd">    x are the points for evaluation</span>
<span class="sd">    y is the data to be fitted</span>
<span class="sd">    bandwidth is a function that returens the smoothing parameter h</span>
<span class="sd">    kernel is a function that gives weights to neighboring data</span>
<span class="sd">    """</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">bandwidth</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">kernel</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">[:,</span> <span class="bp">None</span><span class="p">])</span><span class="o">/</span><span class="n">h</span><span class="p">)</span><span class="o">/</span><span class="n">h</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">density</span> <span class="o">=</span> <span class="n">kde</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">density</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_101_0.png" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/ResamplingAndMonteCarloSimulations_101_0.png">
<p>There are several kernel density estimation routines available in scipy,
statsmodels and scikit-leran. Here we will use the scikits-learn and
statsmodels routine as examples.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="kn">as</span> <span class="nn">sm</span>

<span class="n">dens</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">nonparametric</span><span class="o">.</span><span class="n">KDEUnivariate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">dens</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s">'gau'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">dens</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">xs</span><span class="p">));</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_103_0.png" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/ResamplingAndMonteCarloSimulations_103_0.png">
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KernelDensity</span>

<span class="c"># expects n x p matrix with p features</span>
<span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">xs</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">kde</span> <span class="o">=</span> <span class="n">KernelDensity</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s">'epanechnikov'</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">dens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kde</span><span class="o">.</span><span class="n">score_samples</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">dens</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_104_0.png" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/ResamplingAndMonteCarloSimulations_104_0.png">
</div>
<div class="section" id="multivariate-kerndel-density-estimation">
<h2>Multivariate kerndel density estimation<a class="headerlink" href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#multivariate-kerndel-density-estimation" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># create data set</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">_mus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">_sigmas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]]])</span>
<span class="n">_pis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">pi</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_pis</span><span class="p">,</span> <span class="n">_mus</span><span class="p">,</span> <span class="n">_sigmas</span><span class="p">)])</span>

<span class="n">kde</span> <span class="o">=</span> <span class="n">KernelDensity</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s">'gaussian'</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">dens</span> <span class="o">=</span> <span class="n">kde</span><span class="o">.</span><span class="n">score_samples</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">dens</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/ResamplingAndMonteCarloSimulations_106_0.png" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/ResamplingAndMonteCarloSimulations_106_0.png">
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="https://people.duke.edu/~ccc14/sta-663/ResamplingAndMonteCarloSimulations.html#">Back to top</a>
      
    </p>
    <p>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.<br>
    </p>
  </div>
</footer>
  
<iframe frameborder="0" scrolling="no" style="background-color: transparent; border: 0px; display: none;" src="./Resampling methods — Computational Statistics in Python 0.1 documentation_files/saved_resource.html"></iframe><div id="GOOGLE_INPUT_CHEXT_FLAG" input="" input_stat="{&quot;tlang&quot;:true,&quot;tsbc&quot;:true,&quot;pun&quot;:true,&quot;mk&quot;:true,&quot;ss&quot;:true}" style="display: none;"></div><style>.tb_button {padding:1px;cursor:pointer;border-right: 1px solid #8b8b8b;border-left: 1px solid #FFF;border-bottom: 1px solid #fff;}.tb_button.hover {borer:2px outset #def; background-color: #f8f8f8 !important;}.ws_toolbar {z-index:100000} .ws_toolbar .ws_tb_btn {cursor:pointer;border:1px solid #555;padding:3px}   .tb_highlight{background-color:yellow} .tb_hide {visibility:hidden} .ws_toolbar img {padding:2px;margin:0px}</style><div></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div></body><div id="cye-workaround-body" style="position: absolute; left: 0px; top: 0px; z-index: -2147483646; background: none 0% 0% / auto repeat scroll padding-box border-box rgb(255, 255, 255); height: 22417px; width: 1639px;"></div><div id="cye-workaround-body-image" style="position: absolute; left: 0px; top: 0px; z-index: -2147483645; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0); height: 22417px; width: 1639px;"></div><auto-scroll></auto-scroll></html>